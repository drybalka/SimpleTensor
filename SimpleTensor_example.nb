(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    223859,       5321]
NotebookOptionsPosition[    206081,       5008]
NotebookOutlinePosition[    206412,       5023]
CellTagsIndexPosition[    206369,       5020]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["SimpleTensor examples", "Title",
 CellChangeTimes->{{3.835948745525187*^9, 
  3.835948755100402*^9}},ExpressionUUID->"cd0d1fc8-7cf8-49f1-9b9b-\
2f0e2deeff83"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<SimpleTensor`\>\"", "]"}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"daba3984-9e80-4d1d-a967-4e019fe3d35d"],

Cell[CellGroupData[{

Cell["Electromagnetic tensor", "Chapter",
 CellChangeTimes->{{3.835948771728477*^9, 
  3.835948777532579*^9}},ExpressionUUID->"38c80fbf-f787-4a0b-880e-\
b14a594d1836"],

Cell["\<\
In this chapter we will examine applications of SimpleTensor on the example \
of relativistic electromagnetism.

We start by defining a Minkowski space with mostly negative metric:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836113757866951*^9, 3.836113792068993*^9}, {3.8361138255785427`*^9, 
  3.8361139406697693`*^9}, {3.8361915663541307`*^9, 3.836191588807316*^9}},
 CellID->343544594,ExpressionUUID->"eaee3e8a-c866-4ae1-a615-321dfac92280"],

Cell[BoxData[{
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Minkowski\>\"", ",", "4", ",", 
   RowBox[{"index", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", ",", "\[Rho]"}], 
     "}"}]}], ",", 
   RowBox[{"coord", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "[", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], ",", 
    RowBox[{"-", "\[Nu]"}]}], "]"}], "\[Congruent]", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{3.835948733032742*^9},
 CellLabel->"In[2]:=",
 CellID->189277084,ExpressionUUID->"1ca643c8-6aa1-4d44-82cd-728f79721962"],

Cell["\<\
We define a Levi-Civita tensor and a time direction vector. This can also be \
done using the full function name:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, {3.8359659681054296`*^9, 3.835966027891779*^9}, {
   3.836113997865509*^9, 3.836113999712778*^9}},
 CellID->1459807809,ExpressionUUID->"29e0abc5-42bf-407a-9417-be8cd42b08ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", "[", 
   RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", ",", "\[Rho]"}], "]"}], 
  "\[Congruent]", 
  RowBox[{"Normal", "@", 
   RowBox[{"LeviCivitaTensor", "[", "4", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"SetTensor", "[", 
  RowBox[{
   RowBox[{"T", "[", "\[Mu]", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.835948859168845*^9, {3.8359660347846127`*^9, 
   3.835966048080255*^9}},
 CellLabel->"In[4]:=",
 CellID->272556410,ExpressionUUID->"608dc93d-dfc0-48b7-8ba8-41b5f8132ae5"],

Cell["We define a general electromagnetic potential:", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.836114002274713*^9, 
   3.836114003604556*^9}},
 CellID->565758205,ExpressionUUID->"842082ba-6947-4153-a90d-e4ec1819acbd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "[", "\[Mu]", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"A1", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"A2", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], ",", 
    RowBox[{"A3", "[", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{3.835948733032742*^9, 3.835948859168845*^9, 
  3.835948899103757*^9},
 CellLabel->"In[6]:=",
 CellID->1583466693,ExpressionUUID->"88275b09-39e4-4d8c-8f8d-cbcccd78ddc4"],

Cell["\<\
Individual components of a tensor can be extracted by contracting it with a \
corresponding unit vector. For example, by contracting EM potential with a \
time direction vector we get the corresponding zeroth component - the scalar \
potential:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.8361019642282553`*^9, 3.836101973176824*^9}, {
   3.836114021116644*^9, 3.836114021513239*^9}},
 CellID->247280041,ExpressionUUID->"ce827879-144f-43fe-ab6c-6a99a122f0a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"-", "\[Mu]"}], "]"}], 
   RowBox[{"T", "[", "\[Mu]", "]"}]}], "//", "GetArray"}]], "Input",
 CellChangeTimes->{3.835948733032742*^9, 3.835948859168845*^9, 
  3.835948899103757*^9, 3.835948976764078*^9},
 CellLabel->"In[7]:=",
 CellID->662083154,ExpressionUUID->"4054f000-e24f-4320-b09c-0e1640974472"],

Cell[BoxData[
 RowBox[{"\[Phi]", "[", 
  RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]], "Output",
 CellChangeTimes->{
  3.835948977468133*^9, 3.836101908737409*^9, 3.836103284860667*^9, 
   3.8361038859861937`*^9, 3.83610664686585*^9, 3.8361136898825283`*^9, 
   3.836133436348733*^9, 3.8361337530754547`*^9, {3.836188383569701*^9, 
   3.836188399039152*^9}, 3.836355542587023*^9, 3.836355800156351*^9, 
   3.8363560699795094`*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"9a1e200e-c214-4b67-8fa2-e5b8e7067fd8"]
}, Open  ]],

Cell["\<\


Using the partial derivative tensor operator we can calculate the \
electromagnetic tensor:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8361019785280237`*^9, 3.836101978836905*^9}},
 CellID->146943780,ExpressionUUID->"a1375a16-6401-44d2-acf8-a5ae58a0dffb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[Eth]", "[", 
      RowBox[{"-", "\[Mu]"}], "]"}], "[", 
     RowBox[{"A", "[", 
      RowBox[{"-", "\[Nu]"}], "]"}], "]"}], "-", 
    RowBox[{
     RowBox[{"\[Eth]", "[", 
      RowBox[{"-", "\[Nu]"}], "]"}], "[", 
     RowBox[{"A", "[", 
      RowBox[{"-", "\[Mu]"}], "]"}], "]"}]}], "//", "GetArray"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", "[", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], ",", 
    RowBox[{"-", "\[Nu]"}]}], "]"}], "\[Congruent]", "%"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.835948859168845*^9, 3.835948899103757*^9, {
   3.835948976764078*^9, 3.8359490049974737`*^9}, {3.8359490451964617`*^9, 
   3.8359490497508173`*^9}},
 CellLabel->"In[8]:=",
 CellID->158129306,ExpressionUUID->"0d8c44d8-5e1f-40f9-a1f2-c334a09beea5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["\[Phi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["A1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["\[Phi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["A2", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["\[Phi]", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["A3", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Phi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["A1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["A1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
       RowBox[{
        SuperscriptBox["A2", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["A1", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
       RowBox[{
        SuperscriptBox["A3", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Phi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["A2", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["A1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["A2", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{
        SuperscriptBox["A2", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
       RowBox[{
        SuperscriptBox["A3", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        SuperscriptBox["\[Phi]", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["A3", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["A1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["A3", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["A2", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["A3", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.835948977468133*^9, {3.83594903543443*^9, 3.835949050213594*^9}, 
   3.8361019087754393`*^9, 3.836103284899249*^9, 3.8361038860187893`*^9, 
   3.836106646916458*^9, 3.836113689902769*^9, 3.836133436394004*^9, 
   3.836133753105483*^9, {3.8361883836033792`*^9, 3.8361883990579844`*^9}, 
   3.836355542629266*^9, 3.836355800196007*^9, 3.836356070027918*^9},
 CellLabel->
  "Out[8]//MatrixForm=",ExpressionUUID->"e05ffb89-adf1-4fd5-b205-\
10ca2318f4c4"]
}, Open  ]],

Cell["\<\
The antisymmetry of EM tensor can be shown either elementwise or by summing \
the arrays of normal and transposed arrays:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}},
 CellID->573994711,ExpressionUUID->"bb4bef05-6c6a-4116-8a9e-f82d82d63fec"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"GetArray", "[", 
  RowBox[{
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "\[Mu]"}], ",", 
     RowBox[{"-", "\[Nu]"}]}], "]"}], "+", 
   RowBox[{"F", "[", 
    RowBox[{
     RowBox[{"-", "\[Nu]"}], ",", 
     RowBox[{"-", "\[Mu]"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetArray", "[", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", "\[Mu]"}], ",", 
      RowBox[{"-", "\[Nu]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Mu]"}], ",", 
      RowBox[{"-", "\[Nu]"}]}], "}"}]}], "]"}], "+", 
  RowBox[{"GetArray", "[", 
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", "\[Mu]"}], ",", 
      RowBox[{"-", "\[Nu]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Nu]"}], ",", 
      RowBox[{"-", "\[Mu]"}]}], "}"}]}], "]"}]}]}], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"fd11b4d3-ff91-452a-80db-389233ca2a41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835969560938815*^9, 3.836101908814148*^9, 3.836103284932707*^9, 
   3.8361038860522118`*^9, 3.836106646952629*^9, 3.8361136899262037`*^9, 
   3.836133436426174*^9, 3.836133753136117*^9, {3.836188383635577*^9, 
   3.8361883990769243`*^9}, 3.836355542658496*^9, 3.836355800242197*^9, 
   3.836356070078803*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"7af6955e-519e-4f8c-a885-4a80e57bfcec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.835969560938815*^9, 3.836101908814148*^9, 3.836103284932707*^9, 
   3.8361038860522118`*^9, 3.836106646952629*^9, 3.8361136899262037`*^9, 
   3.836133436426174*^9, 3.836133753136117*^9, {3.836188383635577*^9, 
   3.8361883990769243`*^9}, 3.836355542658496*^9, 3.836355800242197*^9, 
   3.8363560700798798`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"e235c22a-c265-423b-80d5-677bccaf3063"]
}, Open  ]],

Cell["\<\
From the electromagnetic tensor we can extract the vectors of the electric \
and the magnetic fields (both purely spatial):\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}},
 CellID->204766713,ExpressionUUID->"0694a10f-2082-42c6-ad68-4c0a11f9f1ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], 
    RowBox[{"T", "[", 
     RowBox[{"-", "\[Nu]"}], "]"}]}], "//", "GetArray"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"\[Epsilon]", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", ",", "\[Rho]"}], "]"}], 
    
    RowBox[{"F", "[", 
     RowBox[{
      RowBox[{"-", "\[Lambda]"}], ",", 
      RowBox[{"-", "\[Rho]"}]}], "]"}], 
    RowBox[{"T", "[", 
     RowBox[{"-", "\[Nu]"}], "]"}]}], "//", "GetArray"}], "//", 
  "MatrixForm"}]}], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"e58be613-3aeb-4dd4-8918-421e4dd56730"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["\[Phi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["A1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["\[Phi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["A2", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["\[Phi]", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["A3", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.835969641220624*^9, 3.836101908851501*^9, 3.8361032849712563`*^9, 
   3.8361038860857067`*^9, 3.836106646991024*^9, 3.836113689951144*^9, 
   3.836133436455682*^9, 3.836133753168026*^9, {3.8361883836658077`*^9, 
   3.8361883990961018`*^9}, 3.836355542684235*^9, 3.836355800282596*^9, 
   3.836356070129105*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"f3b2e9d8-9edb-486b-9bdc-\
04431445a676"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["A2", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["A3", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{
         SuperscriptBox["A1", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
        RowBox[{
         SuperscriptBox["A3", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
      {
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["A1", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["A2", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.835969641220624*^9, 3.836101908851501*^9, 3.8361032849712563`*^9, 
   3.8361038860857067`*^9, 3.836106646991024*^9, 3.836113689951144*^9, 
   3.836133436455682*^9, 3.836133753168026*^9, {3.8361883836658077`*^9, 
   3.8361883990961018`*^9}, 3.836355542684235*^9, 3.836355800282596*^9, 
   3.836356070130561*^9},
 CellLabel->
  "Out[13]//MatrixForm=",ExpressionUUID->"5b63015c-03d1-4c68-b627-\
fdc501437b9f"]
}, Open  ]],

Cell["\<\


Let us now derive the field part of Maxwell equations. First we define the \
electromagnetic tensor with the field components:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970051944985*^9}, {
   3.836101547855447*^9, 3.836101562279594*^9}, {3.836101600234208*^9, 
   3.836101651861615*^9}, {3.836101697092823*^9, 3.836101705886387*^9}, {
   3.8361017967023897`*^9, 3.8361018225969887`*^9}, {3.836101945379334*^9, 
   3.836101950076783*^9}},
 CellID->1231890411,ExpressionUUID->"94e708a0-e169-438f-8d25-65d3c10bdc0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ffield", "[", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], ",", 
    RowBox[{"-", "\[Nu]"}]}], "]"}], "\[Congruent]", 
  RowBox[{"(", GridBox[{
     {"0", 
      RowBox[{"Ex", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], 
      RowBox[{"Ey", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], 
      RowBox[{"Ez", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]},
     {
      RowBox[{"-", 
       RowBox[{"Ex", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "0", 
      RowBox[{"-", 
       RowBox[{"Bz", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"By", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]},
     {
      RowBox[{"-", 
       RowBox[{"Ey", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"Bz", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"Bx", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
     {
      RowBox[{"-", 
       RowBox[{"Ez", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"-", 
       RowBox[{"By", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
      RowBox[{"Bx", "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "0"}
    }], ")"}]}]], "Input",
 CellChangeTimes->{{3.836100579011238*^9, 3.8361006345174637`*^9}, {
   3.83610072571416*^9, 3.8361007642589407`*^9}, {3.83610084018154*^9, 
   3.836100983566758*^9}, 3.836101278791057*^9, {3.836101453351741*^9, 
   3.836101478667598*^9}, {3.836101662038082*^9, 3.8361016661737623`*^9}, 
   3.8361018287544537`*^9, {3.8361020087643623`*^9, 3.836102009143091*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"1b15b5d6-e06c-4d89-ab47-b46dac357e27"],

Cell["\<\
The field part of the homogeneous Maxwell equations then reads:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970051944985*^9}, {
   3.836101547855447*^9, 3.836101562279594*^9}, {3.836101600234208*^9, 
   3.836101651861615*^9}, {3.8361016823208733`*^9, 3.836101685480276*^9}, {
   3.836101716907342*^9, 3.836101743596134*^9}, 3.836102763585767*^9, 
   3.8363555951951838`*^9},
 CellID->163416474,ExpressionUUID->"2ad60b8e-f285-4b5a-8e56-e55a983cfdd3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Eth]", "[", 
         RowBox[{"-", "\[Lambda]"}], "]"}], "[", 
        RowBox[{"Ffield", "[", 
         RowBox[{
          RowBox[{"-", "\[Mu]"}], ",", 
          RowBox[{"-", "\[Nu]"}]}], "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"\[Eth]", "[", 
         RowBox[{"-", "\[Mu]"}], "]"}], "[", 
        RowBox[{"Ffield", "[", 
         RowBox[{
          RowBox[{"-", "\[Nu]"}], ",", 
          RowBox[{"-", "\[Lambda]"}]}], "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{"\[Eth]", "[", 
         RowBox[{"-", "\[Nu]"}], "]"}], "[", 
        RowBox[{"Ffield", "[", 
         RowBox[{
          RowBox[{"-", "\[Lambda]"}], ",", 
          RowBox[{"-", "\[Mu]"}]}], "]"}], "]"}]}], "//", "GetArray"}], "//", 
     "Flatten"}], "//", 
    RowBox[{"DeleteCases", "[", "0", "]"}]}], "//", 
   RowBox[{"DeleteDuplicatesBy", "[", 
    RowBox[{
     RowBox[{"Sort", "[", 
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{"-", "#"}]}], "}"}], "]"}], "&"}], "]"}]}], "//", 
  "Column"}]], "Input",
 CellChangeTimes->{{3.836100579011238*^9, 3.8361006345174637`*^9}, {
   3.83610072571416*^9, 3.8361007642589407`*^9}, {3.83610084018154*^9, 
   3.836100983566758*^9}, 3.836101278791057*^9, {3.836101453351741*^9, 
   3.836101478667598*^9}, {3.836101662038082*^9, 3.836101675821858*^9}, {
   3.836101832057684*^9, 3.836101835227439*^9}, {3.836102013155734*^9, 
   3.8361020178039637`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"990268cb-c8e1-47ed-a8ea-e03499759924"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       SuperscriptBox["Ex", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Ey", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Bz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
    {
     RowBox[{
      RowBox[{
       SuperscriptBox["Ex", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Ez", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["By", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
    {
     RowBox[{
      RowBox[{
       SuperscriptBox["Ey", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Ez", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Bx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
    {
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        SuperscriptBox["Bz", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["By", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Bx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.836101768838437*^9, 3.8361018396499043`*^9, 3.836101908916584*^9, 
   3.836102027017024*^9, 3.836103285019376*^9, 3.836103886131123*^9, 
   3.836106647047532*^9, 3.8361136899833803`*^9, 3.836133436517498*^9, 
   3.836133753219078*^9, {3.836188383708138*^9, 3.836188399123571*^9}, 
   3.83635554275605*^9, 3.836355800347432*^9, 3.836356070188555*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"20b96c8b-0163-46a7-beca-b3d04b6b2e4b"]
}, Open  ]],

Cell["The field part of the inhomogeneous Maxwell equations:", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970051944985*^9}, {
   3.836101547855447*^9, 3.836101562279594*^9}, {3.836101600234208*^9, 
   3.836101651861615*^9}, {3.836101728959935*^9, 3.836101760431045*^9}},
 CellID->829826839,ExpressionUUID->"7f52ac1b-9f93-4175-a83a-b8152be4f14f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Eth]", "[", 
     RowBox[{"-", "\[Mu]"}], "]"}], "[", 
    RowBox[{"Ffield", "[", 
     RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}], "//", "GetArray"}], "//", 
  "Column"}]], "Input",
 CellChangeTimes->{{3.836100579011238*^9, 3.8361006345174637`*^9}, {
   3.83610072571416*^9, 3.8361007642589407`*^9}, {3.83610084018154*^9, 
   3.836100983566758*^9}, 3.836101278791057*^9, {3.836101453351741*^9, 
   3.836101478667598*^9}, {3.836101662038082*^9, 3.836101675821858*^9}, 
   3.836101841817651*^9, {3.836102021869897*^9, 3.836102022244698*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"4b1cf972-5d90-44c6-9cec-e7814a1de55f"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       SuperscriptBox["Ez", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["Ey", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
      RowBox[{
       SuperscriptBox["Ex", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
    {
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        SuperscriptBox["By", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["Bz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Ex", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
    {
     RowBox[{
      RowBox[{
       SuperscriptBox["Bx", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Bz", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Ey", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]},
    {
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        SuperscriptBox["Bx", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["By", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
      RowBox[{
       SuperscriptBox["Ez", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.836100906501627*^9, 3.836100983963767*^9}, 
   3.8361012799009743`*^9, {3.8361014684829807`*^9, 3.836101479042035*^9}, 
   3.836101770561934*^9, 3.8361018423915052`*^9, 3.8361019089574013`*^9, {
   3.836102023090177*^9, 3.8361020295364637`*^9}, 3.8361032850622787`*^9, 
   3.836103886163659*^9, 3.836106647090642*^9, 3.836113690006111*^9, 
   3.83613343655515*^9, 3.8361337532517242`*^9, {3.8361883837386837`*^9, 
   3.8361883991411324`*^9}, 3.836355542817149*^9, 3.8363558003944197`*^9, 
   3.836356070230788*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"ded1ed3f-6e53-4bc4-987b-632251d11c0f"]
}, Open  ]],

Cell["\<\


The above calculation can also be done using the exterior calculus. Let us \
obtain the electromagnetic potential 1-form by contracting the potential with \
the basis of 1-forms:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970051944985*^9}, {
   3.836101954907856*^9, 3.836101955091771*^9}},
 CellID->603563055,ExpressionUUID->"8d0c4aa5-8f54-49f0-94e5-8528127615b5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Aform", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", 
     RowBox[{"-", "\[Mu]"}], "]"}], 
    RowBox[{"basis", "[", "\[Mu]", "]"}]}], "//", "GetArray"}]}]], "Input",
 CellChangeTimes->{{3.835969937755053*^9, 3.8359699532673883`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"b6ec64ad-c52f-4249-82eb-40396219b845"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "dx"}], " ", 
   RowBox[{"A1", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
  RowBox[{"dy", " ", 
   RowBox[{"A2", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "-", 
  RowBox[{"dz", " ", 
   RowBox[{"A3", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
  RowBox[{"dt", " ", 
   RowBox[{"\[Phi]", "[", 
    RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.835969932336624*^9, 3.8359699648342743`*^9}, 
   3.836101908998281*^9, 3.836103285099839*^9, 3.836103886195348*^9, 
   3.836106647131706*^9, 3.836113690029456*^9, 3.836133436591414*^9, 
   3.836133753282527*^9, {3.836188383769648*^9, 3.836188399158678*^9}, 
   3.836355542865211*^9, 3.8363558004367657`*^9, 3.836356070271872*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"e83c0923-f492-40ae-a3f0-0e73486a7f03"]
}, Open  ]],

Cell["\<\
The electromagnetic field 2-form is the exterior derivative of the potential \
1-form. It is equal to the previously calculated electromagnetic tensor:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}},
 CellID->1839560963,ExpressionUUID->"f508cf7d-cc68-4ceb-80e9-266771d53511"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Fform", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExteriorDerivative", "[", "]"}], "[", "Aform", "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fform", "-", 
    RowBox[{
     RowBox[{"F", "[", 
      RowBox[{
       RowBox[{"-", "\[Mu]"}], ",", 
       RowBox[{"-", "\[Nu]"}]}], "]"}], "*", 
     FractionBox["1", "2"], 
     RowBox[{
      RowBox[{"basis", "[", "\[Mu]", "]"}], "\[Wedge]", 
      RowBox[{"basis", "[", "\[Nu]", "]"}]}]}]}], "//", "GetArray"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8359701177177153`*^9, 3.835970143722076*^9}, {
  3.835970356934931*^9, 3.8359703971900063`*^9}, {3.835976005814756*^9, 
  3.835976013120644*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"29838a3f-e016-436a-ac58-254613eafbfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dy", "\[Wedge]", "dz"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"dx", "\[Wedge]", "dy"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"dx", "\[Wedge]", "dz"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"dt", "\[Wedge]", "dx"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"dt", "\[Wedge]", "dy"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"dt", "\[Wedge]", "dz"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.835970130207144*^9, 3.83597014431264*^9}, 
   3.835970397675984*^9, 3.835976015305706*^9, 3.836101909198709*^9, 
   3.836103285309125*^9, 3.836103886386861*^9, 3.8361066473237553`*^9, 
   3.836113690118883*^9, 3.836133436805784*^9, 3.836133753400126*^9, {
   3.836188383966412*^9, 3.8361883993572397`*^9}, 3.836355542912558*^9, 
   3.836355767978298*^9, 3.8363558006615343`*^9, 3.836356070548102*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"3f80e353-7342-4611-adab-6d8d2f0bc627"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.835970130207144*^9, 3.83597014431264*^9}, 
   3.835970397675984*^9, 3.835976015305706*^9, 3.836101909198709*^9, 
   3.836103285309125*^9, 3.836103886386861*^9, 3.8361066473237553`*^9, 
   3.836113690118883*^9, 3.836133436805784*^9, 3.836133753400126*^9, {
   3.836188383966412*^9, 3.8361883993572397`*^9}, 3.836355542912558*^9, 
   3.836355767978298*^9, 3.8363558006615343`*^9, 3.8363560705733757`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"f7d44a40-28d8-4cb0-ae3c-7b88def6afb3"]
}, Open  ]],

Cell["The homogeneous Maxwell equations are trivially satisfied:", \
"ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.836102749207614*^9, 3.836102752531129*^9}},
 CellID->756486833,ExpressionUUID->"04b70e18-32a6-4807-b4e1-e0a4d4f6c6c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExteriorDerivative", "[", "]"}], "[", "Fform", "]"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8359761844011803`*^9, 3.835976192869213*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"49abdc64-812e-4bb3-9fd1-5dc35c1ffca9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.835976185408655*^9, 3.835976193552555*^9}, 
   3.8361019095098124`*^9, 3.836103285656591*^9, 3.836103886803199*^9, 
   3.83610664778102*^9, 3.836113690465271*^9, 3.8361334372001867`*^9, 
   3.836133753904976*^9, {3.836188384338778*^9, 3.836188399698044*^9}, 
   3.836355543111684*^9, 3.8363558011195793`*^9, 3.8363560710513144`*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"0a85eefe-a53c-41c4-802b-f4bd521f3207"]
}, Open  ]],

Cell["\<\
The field part of the inhomogeneous Maxwell equations (for potentials) can be \
derived using an improvised Hodge star operator:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.8361027162474194`*^9, 3.8361027225300007`*^9}, {
   3.836102792608737*^9, 3.836102822087565*^9}, {3.836103212369544*^9, 
   3.836103268603086*^9}, {3.836133915167755*^9, 3.83613392048076*^9}},
 CellID->275950504,ExpressionUUID->"28930725-1e20-48a4-96fc-220c6aef6d61"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HodgeStar", "[", "f_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmp", "=", 
       RowBox[{"f", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a_", "\[Wedge]", "b_"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"a", "\[CircleTimes]", "b"}], "-", 
           RowBox[{"b", "\[CircleTimes]", "a"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"tmp", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dt", "\[Rule]", "\[Eth]t"}], ",", 
          RowBox[{"dx", "\[Rule]", "\[Eth]x"}], ",", 
          RowBox[{"dy", "\[Rule]", "\[Eth]y"}], ",", 
          RowBox[{"dz", "\[Rule]", "\[Eth]z"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"InteriorProduct", "[", 
        RowBox[{"tmp", ",", 
         RowBox[{
         "dt", "\[Wedge]", "dx", "\[Wedge]", "dy", "\[Wedge]", "dz"}]}], 
        "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExteriorDerivative", "[", "]"}], "[", 
   RowBox[{"HodgeStar", "[", "Fform", "]"}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.83610219940932*^9, 3.8361023303391848`*^9}, {
  3.8361024068481607`*^9, 3.836102460970625*^9}, {3.8361028427518*^9, 
  3.836102944361178*^9}, {3.836103004784821*^9, 3.836103074474058*^9}, {
  3.836103105563781*^9, 3.836103120450534*^9}, {3.836103157581505*^9, 
  3.836103193553034*^9}, {3.836103248749488*^9, 3.8361032641332483`*^9}, {
  3.836103477760311*^9, 3.836103497525619*^9}, {3.836103538204639*^9, 
  3.836103545503766*^9}, {3.836103582904874*^9, 3.836103583811473*^9}, {
  3.836133687625154*^9, 3.8361336889476967`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"53c3696e-7875-475b-bbde-21ecf293b211"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"dx", "\[Wedge]", "dy", "\[Wedge]", "dz"}], ")"}]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"dt", "\[Wedge]", "dy", "\[Wedge]", "dz"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"dt", "\[Wedge]", "dx", "\[Wedge]", "dz"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "0", ",", "2"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"dt", "\[Wedge]", "dx", "\[Wedge]", "dy"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["A2", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["A1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["\[Phi]", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
     RowBox[{
      SuperscriptBox["A3", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.8361022035085506`*^9, {3.836102236369532*^9, 3.836102330983783*^9}, {
   3.836102433094842*^9, 3.836102461549054*^9}, 3.836102952278961*^9, 
   3.836103008849684*^9, {3.836103063917748*^9, 3.83610307817498*^9}, 
   3.836103110009952*^9, 3.836103195634657*^9, 3.836103287285378*^9, 
   3.836103493627874*^9, {3.8361035332184563`*^9, 3.836103546948948*^9}, 
   3.836103586744733*^9, 3.836103888546994*^9, 3.8361066497054358`*^9, 
   3.8361136916080723`*^9, 3.836133438691131*^9, 3.836133755584526*^9, {
   3.836188385764914*^9, 3.836188401332896*^9}, 3.8363555431896267`*^9, 
   3.836355803423128*^9, 3.83635607334899*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"059426fc-46b3-479e-ba80-fcf635e120f7"]
}, Open  ]],

Cell["\<\


Let us now derive the field transformations. First we define a moving space:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.8361027162474194`*^9, 3.8361027225300007`*^9}, {
   3.836102792608737*^9, 3.836102822087565*^9}, {3.836103212369544*^9, 
   3.836103268603086*^9}, {3.836103301337935*^9, 3.836103330068914*^9}, {
   3.8361044053360558`*^9, 3.8361044655698547`*^9}, {3.836104498343997*^9, 
   3.836104549964151*^9}, {3.8361060041804457`*^9, 3.836106059944537*^9}, {
   3.836106091086505*^9, 3.836106093923666*^9}, {3.836106370617852*^9, 
   3.836106372872484*^9}},
 CellID->510016645,ExpressionUUID->"aee8228d-770f-4d4e-b32a-72629c424350"],

Cell[BoxData[
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Moving\>\"", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.836104479580666*^9, 3.8361044841655893`*^9}, {
  3.836106072949149*^9, 3.836106073263771*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f3ab04e9-2e1b-4e08-ab50-30712567d45c"],

Cell["\<\
Next we define the transformation matrix from the original space to the \
moving space with the help of a vielbein (tetrad). As no indices were defined \
in the moving space we will be using the standard generated indices. Let the \
new system be moving in the z-direction with velocity v in natural units:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.8361027162474194`*^9, 3.8361027225300007`*^9}, {
   3.836102792608737*^9, 3.836102822087565*^9}, {3.836103212369544*^9, 
   3.836103268603086*^9}, {3.836103301337935*^9, 3.836103330068914*^9}, {
   3.8361044053360558`*^9, 3.8361044655698547`*^9}, {3.836104498343997*^9, 
   3.836104549964151*^9}, {3.8361060041804457`*^9, 3.8361062751113586`*^9}, {
   3.836107062121255*^9, 3.83610707680754*^9}},
 CellID->676108050,ExpressionUUID->"5ba16f43-80bd-43da-98df-6638f0b6fb7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"metric", "[", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], ",", "iMoving1"}], "]"}], "\[Congruent]", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]], "0", "0", 
       FractionBox[
        RowBox[{"-", "v"}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]]},
      {"0", "1", "0", "0"},
      {"0", "0", "1", "0"},
      {
       FractionBox[
        RowBox[{"-", "v"}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]], "0", "0", 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Input",
 CellChangeTimes->{{3.83610630140086*^9, 3.8361063352846003`*^9}, {
  3.8361064294981203`*^9, 3.8361064295822563`*^9}, {3.836106519124395*^9, 
  3.836106574441855*^9}, {3.8361072872501297`*^9, 3.836107290855262*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"77362800-c451-48f5-87bb-9ec6764ed7db"],

Cell["Let us check that the moving space is also Minkowski:", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.8361027162474194`*^9, 3.8361027225300007`*^9}, {
   3.836102792608737*^9, 3.836102822087565*^9}, {3.836103212369544*^9, 
   3.836103268603086*^9}, {3.836103301337935*^9, 3.836103330068914*^9}, {
   3.8361044053360558`*^9, 3.8361044655698547`*^9}, {3.836104498343997*^9, 
   3.836104549964151*^9}, {3.8361060041804457`*^9, 3.8361062751113586`*^9}, {
   3.836106378807345*^9, 3.83610639238385*^9}},
 CellID->157352642,ExpressionUUID->"1954ecc9-aae5-40d7-9e03-e738cb0784b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"metric", "[", 
     RowBox[{
      RowBox[{"-", "iMoving1"}], ",", 
      RowBox[{"-", "iMoving2"}]}], "]"}], "//", "GetArray"}], "//", 
   "Simplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.836106395328648*^9, 3.8361064509403067`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"bc5bfd70-e6cc-4f3c-8da6-8b273f33c0d8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.836106421543036*^9, 3.8361064512945642`*^9}, {
   3.836106577404866*^9, 3.836106589558367*^9}, 3.836106649863081*^9, 
   3.836107293412668*^9, 3.8361136916478033`*^9, 3.836133438759349*^9, 
   3.836133757151731*^9, {3.836188385966419*^9, 3.836188401397687*^9}, 
   3.836355543225539*^9, 3.836355803557444*^9, 3.836356073482985*^9},
 CellLabel->
  "Out[25]//MatrixForm=",ExpressionUUID->"3f789ef4-84f9-4a83-9959-\
f7dfed02ca26"]
}, Open  ]],

Cell["\<\
We also define the time direction vector in the moving space:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.8361027162474194`*^9, 3.8361027225300007`*^9}, {
   3.836102792608737*^9, 3.836102822087565*^9}, {3.836103212369544*^9, 
   3.836103268603086*^9}, {3.836103301337935*^9, 3.836103330068914*^9}, {
   3.8361044053360558`*^9, 3.8361044655698547`*^9}, {3.836104498343997*^9, 
   3.836104549964151*^9}, {3.8361060041804457`*^9, 3.8361062751113586`*^9}, {
   3.836106378807345*^9, 3.83610639238385*^9}, {3.836110699508257*^9, 
   3.836110739401969*^9}, {3.836110790033587*^9, 3.836110812224052*^9}, 
   3.83611084632978*^9},
 CellID->1846150399,ExpressionUUID->"6fbbe824-a5a3-4a2f-ada8-77007a73ea7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tmoving", "[", "iMoving0", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.836106395328648*^9, 3.8361064509403067`*^9}, {
  3.8361108173667803`*^9, 3.8361108340800743`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"97f6b52e-c5ec-44a0-b3d4-06fa52f1106b"],

Cell["\<\
Now we can easily derive the electric and magnetic fields in the moving frame:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.8361027162474194`*^9, 3.8361027225300007`*^9}, {
   3.836102792608737*^9, 3.836102822087565*^9}, {3.836103212369544*^9, 
   3.836103268603086*^9}, {3.836103301337935*^9, 3.836103330068914*^9}, {
   3.8361044053360558`*^9, 3.8361044655698547`*^9}, {3.836104498343997*^9, 
   3.836104549964151*^9}, {3.8361060041804457`*^9, 3.8361062751113586`*^9}, {
   3.836106378807345*^9, 3.83610639238385*^9}, {3.836110699508257*^9, 
   3.836110739401969*^9}, {3.836110790033587*^9, 3.836110812224052*^9}, {
   3.836110852065497*^9, 3.836110893458996*^9}, {3.836110987936543*^9, 
   3.836110988493288*^9}, {3.836111637365839*^9, 3.836111637886647*^9}},
 CellID->121348350,ExpressionUUID->"11ebc0bf-7176-4ea2-982e-edd52122cb88"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ffield", "[", 
      RowBox[{"iMoving0", ",", "iMoving1"}], "]"}], 
     RowBox[{"Tmoving", "[", 
      RowBox[{"-", "iMoving1"}], "]"}]}], "//", "GetArray"}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], 
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"iMoving0", ",", "iMoving1", ",", "iMoving2", ",", "iMoving3"}],
       "]"}], 
     RowBox[{"Ffield", "[", 
      RowBox[{
       RowBox[{"-", "iMoving2"}], ",", 
       RowBox[{"-", "iMoving3"}]}], "]"}], 
     RowBox[{"Tmoving", "[", 
      RowBox[{"-", "iMoving1"}], "]"}]}], "//", "GetArray"}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.836106395328648*^9, 3.8361064509403067`*^9}, {
   3.8361108173667803`*^9, 3.8361108340800743`*^9}, {3.8361110266609364`*^9, 
   3.836111055328842*^9}, {3.836111316948133*^9, 3.836111380160582*^9}, 
   3.836111580961725*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"478b9e5a-a3e7-4ed0-9b4f-9c77e2ec5f0e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "v"}], " ", 
          RowBox[{"By", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"Ex", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"v", " ", 
          RowBox[{"Bx", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], "+", 
         RowBox[{"Ey", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]]},
      {
       RowBox[{"Ez", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.836111044310541*^9, 3.836111055886978*^9}, {
   3.83611135780488*^9, 3.836111380585001*^9}, 3.836111581348462*^9, 
   3.836113691689206*^9, 3.8361334388245*^9, 3.83613375720858*^9, {
   3.8361883860405416`*^9, 3.836188401459051*^9}, 3.8363555433264027`*^9, 
   3.836355803651463*^9, 3.836356073631036*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"335f8c25-45b5-41e5-b86f-\
b4518c76c058"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0"},
      {
       FractionBox[
        RowBox[{
         RowBox[{"Bx", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "+", 
         RowBox[{"v", " ", 
          RowBox[{"Ey", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{"By", "[", 
          RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}], "-", 
         RowBox[{"v", " ", 
          RowBox[{"Ex", "[", 
           RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}]}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]]},
      {
       RowBox[{"Bz", "[", 
        RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "]"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.836111044310541*^9, 3.836111055886978*^9}, {
   3.83611135780488*^9, 3.836111380585001*^9}, 3.836111581348462*^9, 
   3.836113691689206*^9, 3.8361334388245*^9, 3.83613375720858*^9, {
   3.8361883860405416`*^9, 3.836188401459051*^9}, 3.8363555433264027`*^9, 
   3.836355803651463*^9, 3.83635607368684*^9},
 CellLabel->
  "Out[28]//MatrixForm=",ExpressionUUID->"a8a24132-0f77-448c-8566-\
12637a41f225"]
}, Open  ]],

Cell["\<\
When the space is no longer needed the following command effectively deletes \
it and all definitions connected to it:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, 
   3.835948846261525*^9, 3.83594888802037*^9, {3.835948944688558*^9, 
   3.8359489593241158`*^9}, {3.835948993133625*^9, 3.835949032023168*^9}, {
   3.8359695383016872`*^9, 3.8359695470995092`*^9}, 3.835969609701435*^9, {
   3.835969683668728*^9, 3.835969734956012*^9}, {3.8359697653522167`*^9, 
   3.835969875203191*^9}, {3.835970045989748*^9, 3.835970112922347*^9}, {
   3.8359701502402077`*^9, 3.835970151175489*^9}, {3.835970201800417*^9, 
   3.835970231475318*^9}, {3.8359703255262003`*^9, 3.835970350966072*^9}, {
   3.835976037692986*^9, 3.835976084958547*^9}, {3.8359761588028727`*^9, 
   3.835976160098435*^9}, {3.8361027162474194`*^9, 3.8361027225300007`*^9}, {
   3.836102792608737*^9, 3.836102822087565*^9}, {3.836103212369544*^9, 
   3.836103268603086*^9}, {3.836103301337935*^9, 3.836103330068914*^9}, {
   3.8361044053360558`*^9, 3.8361044655698547`*^9}, {3.836104498343997*^9, 
   3.836104549964151*^9}, {3.8361060041804457`*^9, 3.8361062751113586`*^9}, {
   3.836106378807345*^9, 3.83610639238385*^9}, {3.836110699508257*^9, 
   3.836110739401969*^9}, {3.836110790033587*^9, 3.836110812224052*^9}, 
   3.83611084632978*^9, {3.8361135460337467`*^9, 3.836113589843748*^9}, {
   3.836113654567021*^9, 3.8361136604287567`*^9}},
 CellID->919012536,ExpressionUUID->"54733539-090b-43ac-9030-21a404abbb85"],

Cell[BoxData[{
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Moving\>\"", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Minkowski\>\"", ",", "0"}], "]"}]}], "Input",
 CellChangeTimes->{{3.836106395328648*^9, 3.8361064509403067`*^9}, {
  3.8361108173667803`*^9, 3.8361108340800743`*^9}, {3.8361135932864122`*^9, 
  3.8361136053664837`*^9}, {3.836113668511269*^9, 3.836113672505865*^9}, {
  3.8361137071380787`*^9, 3.836113708378512*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"1e2e3525-8219-4c7b-964d-19f1ca16ad2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Spinors\
\>", "Chapter",
 CellChangeTimes->{{3.835948771728477*^9, 3.835948777532579*^9}, {
   3.836113484856694*^9, 3.8361134861925163`*^9}, 3.836113610008952*^9, {
   3.836113738901141*^9, 
   3.8361137417511063`*^9}},ExpressionUUID->"52a6ec49-47aa-4559-a887-\
2d317fb95d3b"],

Cell["\<\
In this chapter we will examine applications of SimpleTensor to Dirac and \
Weyl particles.

We start again by defining a Minkowski space with mostly negative metric, \
Levi-Civita tensor and time-direction 4-vector:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
   3.836114212810073*^9}, {3.836114244386598*^9, 3.836114270404917*^9}, {
   3.836114375221878*^9, 3.836114398389288*^9}, {3.836117746175971*^9, 
   3.836117758668296*^9}, 3.8361915837253513`*^9},
 CellID->152417909,ExpressionUUID->"d41ab275-fe74-47b8-9b5b-c010ee87f1ab"],

Cell[BoxData[{
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Minkowski\>\"", ",", "4", ",", 
   RowBox[{"index", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", ",", "\[Rho]", ",", "\[Alpha]", 
      ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]"}], "}"}]}], ",", 
   RowBox[{"coord", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "x", ",", "y", ",", "z"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "[", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], ",", 
    RowBox[{"-", "\[Nu]"}]}], "]"}], "\[Congruent]", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]", "[", 
   RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", ",", "\[Rho]"}], "]"}], 
  "\[Congruent]", 
  RowBox[{"Normal", "@", 
   RowBox[{"LeviCivitaTensor", "[", "4", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "[", "\[Mu]", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836114426908383*^9, 3.8361144271734867`*^9}, {
   3.83611776141672*^9, 3.836117768703755*^9}, {3.836122788325087*^9, 
   3.836122793071227*^9}},
 CellLabel->"In[31]:=",
 CellID->345325393,ExpressionUUID->"570a4092-9a3c-4067-959d-a54a011f6073"],

Cell["\<\
Let us also introduce a convenient conjugate-transpose and adjoint operations:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
  3.836114212810073*^9}, {3.836114244386598*^9, 3.836114270404917*^9}, {
  3.836114375221878*^9, 3.836114398389288*^9}, {3.8361160565160217`*^9, 
  3.836116070958765*^9}, {3.83611803104952*^9, 3.8361180321231194`*^9}, {
  3.836118575105695*^9, 3.8361186016939907`*^9}},
 CellID->576975665,ExpressionUUID->"0d46bc73-92c7-4fa2-823e-9a73df5958fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dagger", "[", "a_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"a", "/.", 
       RowBox[{
        RowBox[{"Complex", "[", 
         RowBox[{"r_", ",", "i_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{"Complex", "[", 
         RowBox[{"r", ",", 
          RowBox[{"-", "i"}]}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "res", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "x_"}], "}"}]}], "]"}], ",", 
       RowBox[{"Transpose", "@", "res"}], ",", "res"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bar", "[", "\[Psi]_", "]"}], ":=", 
  RowBox[{
   RowBox[{"dagger", "[", "\[Psi]", "]"}], ".", 
   RowBox[{"GetArray", "[", 
    RowBox[{
     RowBox[{"T", "[", "\[Mu]", "]"}], 
     RowBox[{"\[Gamma]", "[", 
      RowBox[{"-", "\[Mu]"}], "]"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836114426908383*^9, 3.8361144271734867`*^9}, 
   3.83611607549968*^9, {3.836118038591977*^9, 3.836118067350999*^9}},
 CellLabel->"In[35]:=",
 CellID->1520145477,ExpressionUUID->"1218a30b-8f83-4e3e-9d9d-4476a383e5a2"],

Cell["\<\
Next we define a 4-vector of gamma (Dirac) matrices, the \
\[OpenCurlyDoubleQuote]fifth\[CloseCurlyDoubleQuote] gamma matrix and a set \
of sigma matrices:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
  3.836114212810073*^9}, {3.836114244386598*^9, 3.836114337172852*^9}, {
  3.836116807682653*^9, 3.8361168173466377`*^9}, {3.8361186872802343`*^9, 
  3.836118689617092*^9}, {3.836121843548283*^9, 3.8361218641841*^9}},
 CellID->1973446229,ExpressionUUID->"3fe13347-507f-4e0d-a154-daaf471ac994"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"(", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", "1"},
       {"1", "0", "0", "0"},
       {"0", "1", "0", "0"}
      }], ")"}], ",", 
    RowBox[{"(", GridBox[{
       {"0", "0", "0", "1"},
       {"0", "0", "1", "0"},
       {"0", 
        RowBox[{"-", "1"}], "0", "0"},
       {
        RowBox[{"-", "1"}], "0", "0", "0"}
      }], ")"}], ",", 
    RowBox[{"(", GridBox[{
       {"0", "0", "0", 
        RowBox[{"-", "\[ImaginaryI]"}]},
       {"0", "0", "\[ImaginaryI]", "0"},
       {"0", "\[ImaginaryI]", "0", "0"},
       {
        RowBox[{"-", "\[ImaginaryI]"}], "0", "0", "0"}
      }], ")"}], ",", 
    RowBox[{"(", GridBox[{
       {"0", "0", "1", "0"},
       {"0", "0", "0", 
        RowBox[{"-", "1"}]},
       {
        RowBox[{"-", "1"}], "0", "0", "0"},
       {"0", "1", "0", "0"}
      }], ")"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"\[Gamma]5", "=", 
    RowBox[{"GetArray", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "I"}], "24"], " ", 
      RowBox[{"\[Epsilon]", "[", 
       RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Rho]", ",", "\[Lambda]"}], 
       "]"}], 
      RowBox[{
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"-", "\[Mu]"}], "]"}], ".", 
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"-", "\[Nu]"}], "]"}], ".", 
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"-", "\[Rho]"}], "]"}], ".", 
       RowBox[{"\[Gamma]", "[", 
        RowBox[{"-", "\[Lambda]"}], "]"}]}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "[", 
    RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "\[Congruent]", 
   RowBox[{"GetArray", "[", 
    RowBox[{
     FractionBox["\[ImaginaryI]", "2"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}], ".", 
        RowBox[{"\[Gamma]", "[", "\[Nu]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"\[Gamma]", "[", "\[Nu]", "]"}], ".", 
        RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}]}]}], ")"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.8361168198120193`*^9, 
   3.836116860992835*^9}, {3.836121881768828*^9, 3.8361219176352053`*^9}},
 CellLabel->"In[37]:=",
 CellID->323686400,ExpressionUUID->"1b1ca40e-7dbd-44a7-866d-243ffa71e0c1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.836116828910407*^9, 3.8361168615251102`*^9, 3.8361178180013*^9, 
   3.8361219235266037`*^9, 3.8361227969662857`*^9, 3.836133453377392*^9, {
   3.836188386394307*^9, 3.83618840173337*^9}, 3.8361900703843517`*^9, {
   3.836190171775216*^9, 3.836190197189114*^9}, 3.836190696131259*^9, 
   3.836190861720212*^9, 3.836355543600089*^9, 3.836355803902562*^9, 
   3.836356073885758*^9},
 CellLabel->
  "Out[38]//MatrixForm=",ExpressionUUID->"a76b8baf-0150-4438-9ca3-\
dca3201dbaa9"]
}, Open  ]],

Cell["\<\
Next let us find a plane-wave solution to the Dirac equation for a particle \
with mass m and momentum p. First we define the 4-momentum and write the \
matrix part of the Dirac equation. Note that when adding a list-valued tensor \
to an explicit Mathematica list one should use the TensorPlus (\[CirclePlus]) \
operator. Otherwise Mathematica automatically threads the tensor inside the \
explicit list before any computation can take place yielding a list of lists \
in the result.:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
  3.836114212810073*^9}, {3.836114244386598*^9, 3.836114337172852*^9}, {
  3.836114634889106*^9, 3.836114662732606*^9}, {3.836114727625678*^9, 
  3.836114728684002*^9}, {3.836114786165081*^9, 3.836114982602573*^9}, {
  3.836115057920229*^9, 3.836115086811659*^9}, {3.836115871958973*^9, 
  3.8361158730661297`*^9}, {3.8361916533143806`*^9, 3.8361916575018167`*^9}},
 CellID->1660613409,ExpressionUUID->"136a0ccc-02a3-4395-a9e2-f71665a8d91c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "[", "\[Mu]", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{"p0", ",", "p1", ",", "p2", ",", "p3"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"EqDirac", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"-", "\[Mu]"}], "]"}], 
       RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}]}], "\[CirclePlus]", 
      RowBox[{"m", " ", 
       RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "//", "GetArray"}]}], 
   ")"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.836116150372513*^9, 3.836116163977022*^9}, {3.836116927398835*^9, 
   3.836116928442203*^9}},
 CellLabel->"In[40]:=",
 CellID->136406356,ExpressionUUID->"44643aaa-3fff-45b2-80a1-e5df0bbb8f38"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"m", "0", 
      RowBox[{"p0", "-", "p3"}], 
      RowBox[{
       RowBox[{"-", "p1"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "p2"}]}]},
     {"0", "m", 
      RowBox[{
       RowBox[{"-", "p1"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "p2"}]}], 
      RowBox[{"p0", "+", "p3"}]},
     {
      RowBox[{"p0", "+", "p3"}], 
      RowBox[{"p1", "-", 
       RowBox[{"\[ImaginaryI]", " ", "p2"}]}], "m", "0"},
     {
      RowBox[{"p1", "+", 
       RowBox[{"\[ImaginaryI]", " ", "p2"}]}], 
      RowBox[{"p0", "-", "p3"}], "0", "m"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.836115098578579*^9, 3.836115102180608*^9}, 
   3.836115138047524*^9, 3.836116120481307*^9, {3.836116151522685*^9, 
   3.836116165599637*^9}, 3.836117818024581*^9, 3.8361219235500317`*^9, 
   3.836122796991506*^9, 3.8361334534050217`*^9, {3.836188386436142*^9, 
   3.836188401752802*^9}, 3.836190070414184*^9, {3.836190171806199*^9, 
   3.8361901972162046`*^9}, 3.836190696159308*^9, 3.836190861751327*^9, 
   3.836355543787928*^9, 3.8363558039404573`*^9, 3.836356073939489*^9},
 CellLabel->
  "Out[41]//MatrixForm=",ExpressionUUID->"239ac88e-303b-41ce-b1ed-\
7b713072e6f4"]
}, Open  ]],

Cell["\<\
Let us now find the dispersion. A non-trivial solution exists only when the \
determinant is non-zero.\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
  3.836114212810073*^9}, {3.836114244386598*^9, 3.836114337172852*^9}, {
  3.836114634889106*^9, 3.836114662732606*^9}, {3.836114727625678*^9, 
  3.836114728684002*^9}, {3.836114786165081*^9, 3.836114982602573*^9}, {
  3.836115057920229*^9, 3.836115086811659*^9}, {3.8361151543331842`*^9, 
  3.836115203206052*^9}, {3.836115529243017*^9, 3.836115540148683*^9}, {
  3.836115607023793*^9, 3.836115662138063*^9}, {3.836115710010109*^9, 
  3.8361157377695713`*^9}, {3.83611577234447*^9, 3.8361158778884563`*^9}, {
  3.836191625505383*^9, 3.836191643470675*^9}},
 CellID->2087189712,ExpressionUUID->"41273dd9-3689-4127-8272-d02cdeea9562"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Det", "[", "EqDirac", "]"}], "\[Equal]", "0"}], ",", "p0"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}},
 CellLabel->"In[42]:=",
 CellID->1977322344,ExpressionUUID->"ff7621e5-616c-4ad9-877d-8b0000e7585d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p0", "\[Rule]", 
     RowBox[{"-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["m", "2"], "+", 
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p0", "\[Rule]", 
     RowBox[{"-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["m", "2"], "+", 
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p0", "\[Rule]", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["m", "2"], "+", 
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p0", "\[Rule]", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["m", "2"], "+", 
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.836115098578579*^9, 3.836115102180608*^9}, 
   3.836115138047524*^9, {3.836115215313843*^9, 3.836115237072248*^9}, 
   3.836116120503943*^9, 3.836116155067227*^9, 3.83611781804718*^9, 
   3.8361219235765963`*^9, 3.8361227970212097`*^9, 3.836133453427103*^9, {
   3.83618838647586*^9, 3.83618840176915*^9}, 3.8361900704404716`*^9, {
   3.8361901718336*^9, 3.836190197242834*^9}, 3.836190696185416*^9, 
   3.836190861779537*^9, 3.836355543822507*^9, 3.836355803974012*^9, 
   3.83635607398565*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"8379150b-ef67-4094-acbc-f190f7fb3ef7"]
}, Open  ]],

Cell["\<\
This is a doubly-degenerate dispersion for Dirac particles and \
anti-particles. Let us choose the positive branch and find the conveniently \
normalized bi-spinor solution:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
  3.836114212810073*^9}, {3.836114244386598*^9, 3.836114337172852*^9}, {
  3.836114634889106*^9, 3.836114662732606*^9}, {3.836114727625678*^9, 
  3.836114728684002*^9}, {3.836114786165081*^9, 3.836114982602573*^9}, {
  3.836115057920229*^9, 3.836115086811659*^9}, {3.8361151543331842`*^9, 
  3.836115203206052*^9}, {3.836115336738123*^9, 3.836115412350721*^9}, {
  3.836116008401977*^9, 3.8361160089798307`*^9}, {3.8361169503042994`*^9, 
  3.836117000130138*^9}, {3.83611813363666*^9, 3.836118154021948*^9}, {
  3.836119697023138*^9, 3.836119698674096*^9}, {3.8361916475366297`*^9, 
  3.836191648073348*^9}},
 CellID->1740822085,ExpressionUUID->"55619e2a-379f-4570-8173-6cc964862e28"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EqDirac", "/.", 
   RowBox[{"p0", "\[Rule]", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["p1", "2"], "+", 
      SuperscriptBox["p2", "2"], "+", 
      SuperscriptBox["p3", "2"]}]]}]}], "//", 
  "NullSpace"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]", "=", 
   RowBox[{
    FractionBox["m", 
     SqrtBox[
      RowBox[{"p3", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["m", "2"], "+", 
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}]]}]]], 
    RowBox[{"First", "[", "%", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, {
   3.8361171027923183`*^9, 3.836117237141241*^9}, {3.8361173631915407`*^9, 
   3.836117412927627*^9}, {3.8361178549332314`*^9, 3.836117886517375*^9}, 
   3.836117922019435*^9, 3.836117956088431*^9, {3.836118005495388*^9, 
   3.836118008813731*^9}, 3.836118127492691*^9, {3.836118230625902*^9, 
   3.836118235614305*^9}, {3.836119136391111*^9, 3.836119143559669*^9}, {
   3.836119475104258*^9, 3.836119509141006*^9}, {3.836119587800145*^9, 
   3.836119593809101*^9}},
 CellLabel->"In[43]:=",
 CellID->1702545356,ExpressionUUID->"79fc6dd9-d3f1-45e9-bff7-d497ea10c598"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "+", 
        RowBox[{"\[ImaginaryI]", " ", "p2"}]}], "m"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"p3", "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}]]}], "m"]}], ",", "0", ",", "1"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p3"}], "+", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}]]}], "m"]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "p1"}], "-", 
        RowBox[{"\[ImaginaryI]", " ", "p2"}]}], "m"]}], ",", "1", ",", "0"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.836115098578579*^9, 3.836115102180608*^9}, 
   3.836115138047524*^9, {3.836115215313843*^9, 3.836115237072248*^9}, {
   3.836115431832793*^9, 3.8361154375425*^9}, {3.836115975180195*^9, 
   3.836115978622528*^9}, 3.836116120529924*^9, 3.836116157471627*^9, {
   3.836117116488853*^9, 3.836117161371735*^9}, {3.8361172030380573`*^9, 
   3.836117207124807*^9}, 3.836117238012743*^9, {3.836117382082367*^9, 
   3.83611741381625*^9}, 3.836117818070222*^9, 3.836117856474606*^9, 
   3.836117887825407*^9, 3.8361179229870243`*^9, 3.836117957073186*^9, 
   3.836118009700045*^9, {3.8361181290130043`*^9, 3.8361181569314213`*^9}, 
   3.83611823859096*^9, 3.83611914754573*^9, 3.836119514423674*^9, 
   3.8361195945024853`*^9, 3.8361219236028557`*^9, 3.836122797044742*^9, 
   3.836133453447893*^9, {3.836188386519315*^9, 3.836188401786974*^9}, 
   3.8361900704704733`*^9, {3.836190171862135*^9, 3.836190197269602*^9}, 
   3.836190696211625*^9, 3.836190861806929*^9, 3.836355543857373*^9, 
   3.836355804025764*^9, 3.836356074032001*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"d220b1c4-ba65-4469-8762-d0dee645016f"]
}, Open  ]],

Cell["\<\
Let us check that this spinor has the right current (the factor 2 is because \
of \[Psi] being a bi-spinor):\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
  3.836114212810073*^9}, {3.836114244386598*^9, 3.836114337172852*^9}, {
  3.836114634889106*^9, 3.836114662732606*^9}, {3.836114727625678*^9, 
  3.836114728684002*^9}, {3.836114786165081*^9, 3.836114982602573*^9}, {
  3.836115057920229*^9, 3.836115086811659*^9}, {3.8361151543331842`*^9, 
  3.836115203206052*^9}, {3.836115336738123*^9, 3.836115412350721*^9}, {
  3.836115994256173*^9, 3.836116030259225*^9}, {3.83611970826821*^9, 
  3.836119735435721*^9}, {3.836119952660564*^9, 3.836119961511778*^9}, {
  3.836120020254429*^9, 3.836120029625772*^9}, {3.836120420616272*^9, 
  3.836120445830371*^9}},
 CellID->1638289005,ExpressionUUID->"9ab5d662-d400-494a-9e77-f6bf76a6a46d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bar", "[", "\[Psi]", "]"}], ".", 
    RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}], ".", "\[Psi]"}], " ", "//", 
   "GetArray"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, 
   3.836116034403319*^9, {3.8361161039022207`*^9, 3.8361161163380404`*^9}, {
   3.836117269695117*^9, 3.83611727327763*^9}, {3.836117490355998*^9, 
   3.836117491045287*^9}, {3.836117692013042*^9, 3.836117695454706*^9}, {
   3.836117780004839*^9, 3.836117790514974*^9}, {3.836118075471648*^9, 
   3.836118079260954*^9}, {3.836118335155142*^9, 3.8361183441563387`*^9}, {
   3.8361191559241877`*^9, 3.836119186837718*^9}, 3.836119520916081*^9, {
   3.836119603684318*^9, 3.83611960382892*^9}},
 CellLabel->"In[45]:=",
 CellID->884991326,ExpressionUUID->"3a58129a-c7f9-4c3e-9122-4f146a62c65c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["p1", "2"], "+", 
      SuperscriptBox["p2", "2"], "+", 
      SuperscriptBox["p3", "2"]}]]}], ",", 
   RowBox[{"2", " ", "p1"}], ",", 
   RowBox[{"2", " ", "p2"}], ",", 
   RowBox[{"2", " ", "p3"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.836115098578579*^9, 3.836115102180608*^9}, 
   3.836115138047524*^9, {3.836115215313843*^9, 3.836115237072248*^9}, {
   3.836115431832793*^9, 3.8361154375425*^9}, {3.836115975180195*^9, 
   3.836115978622528*^9}, 3.8361161205602207`*^9, 3.836116159938999*^9, 
   3.836117241073889*^9, 3.83611727448813*^9, 3.836117440784184*^9, 
   3.836117491764161*^9, {3.836117792032866*^9, 3.8361178181499977`*^9}, 
   3.836117871499404*^9, {3.836117910229932*^9, 3.836117925431119*^9}, 
   3.836117958999278*^9, 3.8361180124488497`*^9, 3.8361180796861763`*^9, 
   3.8361181594832687`*^9, 3.836118245446931*^9, 3.83611834462906*^9, {
   3.8361191593774643`*^9, 3.8361191872063007`*^9}, 3.836119521488336*^9, {
   3.836119596739066*^9, 3.836119604270556*^9}, 3.836121923629599*^9, 
   3.83612279707367*^9, 3.836133453542633*^9, {3.836188386615601*^9, 
   3.836188401885459*^9}, 3.83619007050165*^9, {3.836190171888208*^9, 
   3.836190197295352*^9}, 3.836190696236027*^9, 3.8361908618374567`*^9, 
   3.836355543971353*^9, 3.836355804168384*^9, 3.836356074229847*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"6ff752fd-6257-4e53-807e-2d7bd5b1c2f7"]
}, Open  ]],

Cell["\<\
As a more advanced result, the Berry connection of the bi-spinor is zero \
because the Berry connections of comprising left and right spinors cancel \
each other:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836114035724866*^9, 3.836114040916617*^9}, {3.836114131262154*^9, 
  3.836114212810073*^9}, {3.836114244386598*^9, 3.836114337172852*^9}, {
  3.836114634889106*^9, 3.836114662732606*^9}, {3.836114727625678*^9, 
  3.836114728684002*^9}, {3.836114786165081*^9, 3.836114982602573*^9}, {
  3.836115057920229*^9, 3.836115086811659*^9}, {3.8361151543331842`*^9, 
  3.836115203206052*^9}, {3.836115336738123*^9, 3.836115412350721*^9}, {
  3.836115994256173*^9, 3.836116030259225*^9}, {3.83611970826821*^9, 
  3.836119735435721*^9}, {3.836119952660564*^9, 3.836119961511778*^9}, {
  3.836120020254429*^9, 3.836120029625772*^9}, {3.836120420616272*^9, 
  3.836120445830371*^9}, {3.836120660590459*^9, 3.836120696337222*^9}, {
  3.8361207277273283`*^9, 3.836120795075398*^9}, {3.836121290175106*^9, 
  3.836121300215661*^9}},
 CellID->1007373254,ExpressionUUID->"66e679c3-2ad4-4cca-9ff9-2e581ef10ced"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{
      RowBox[{"bar", "[", "\[Psi]", "]"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{"\[Psi]", ",", "#"}], "]"}]}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]L", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "4", "]"}], "-", "\[Gamma]5"}], "2"], 
    ".", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]R", "=", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "4", "]"}], "+", "\[Gamma]5"}], "2"], 
    ".", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"bar", "[", "\[Psi]R", "]"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{"\[Psi]L", ",", "#"}], "]"}]}], "\[Equal]", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"bar", "[", "\[Psi]L", "]"}], ".", 
       RowBox[{"D", "[", 
        RowBox[{"\[Psi]R", ",", "#"}], "]"}]}]}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8361205597683477`*^9, 3.836120586625532*^9}, {
  3.836120879554139*^9, 3.836120893501968*^9}, {3.836120990035062*^9, 
  3.836121082712041*^9}, {3.836121120692807*^9, 3.836121145981134*^9}, {
  3.836121178442903*^9, 3.836121217955391*^9}, {3.8361214545210943`*^9, 
  3.836121503554632*^9}, {3.8361335426923943`*^9, 3.836133595409731*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"cc84a027-7de8-4ca6-8c26-de2b1e5237a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.836120566028817*^9, 3.836120587144573*^9}, {
   3.83612102990702*^9, 3.836121084205654*^9}, {3.836121136938891*^9, 
   3.8361211464682913`*^9}, 3.836121182746636*^9, {3.836121468610365*^9, 
   3.836121503921722*^9}, 3.836121923656386*^9, 3.836122797150983*^9, 
   3.8361334535663433`*^9, {3.8361335436074266`*^9, 3.836133596092189*^9}, {
   3.836188386652433*^9, 3.8361884019120607`*^9}, 3.8361900705311193`*^9, {
   3.836190171915254*^9, 3.836190197322867*^9}, 3.8361906962603207`*^9, 
   3.836190861866022*^9, 3.836355543999308*^9, 3.836355804204575*^9, 
   3.836356074302925*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"17dddcee-28f9-478d-92be-9b1e474be46c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.836120566028817*^9, 3.836120587144573*^9}, {
   3.83612102990702*^9, 3.836121084205654*^9}, {3.836121136938891*^9, 
   3.8361211464682913`*^9}, 3.836121182746636*^9, {3.836121468610365*^9, 
   3.836121503921722*^9}, 3.836121923656386*^9, 3.836122797150983*^9, 
   3.8361334535663433`*^9, {3.8361335436074266`*^9, 3.836133596092189*^9}, {
   3.836188386652433*^9, 3.8361884019120607`*^9}, 3.8361900705311193`*^9, {
   3.836190171915254*^9, 3.836190197322867*^9}, 3.8361906962603207`*^9, 
   3.836190861866022*^9, 3.836355543999308*^9, 3.836355804204575*^9, 
   3.8363560743053102`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"2e19edb3-3e14-47e1-b3b7-6d3086c5cc13"]
}, Open  ]],

Cell["\<\


Let us now quickly calculate the Berry potential for a Weyl particle, as it \
will be needed in the next chapter. First we define a 4-vector of Pauli \
matrices and write the equation for a right-handed Weyl spinor:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5Ecz2ddApEt53iOg+i3dy+XwLRKzOTboPoilmukpeA9KZn
bVIg2vxB0vzPQPqp9MZVIPpUsNMWEK2ZXbgDRE9zrin7AqTv2faCaQDVXb1g

  "],
 CellID->1776829056,ExpressionUUID->"492c78ed-014a-4722-a20f-f3c51b57adf7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]", "[", "\[Mu]", "]"}], "\[Congruent]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"PauliMatrix", "[", "i", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"EqWeyl", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"-", "\[Mu]"}], "]"}], 
      RowBox[{"\[Sigma]", "[", "\[Mu]", "]"}]}], "//", "GetArray"}]}], ")"}], 
  "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8361205597683477`*^9, 3.836120586625532*^9}, {
   3.836120879554139*^9, 3.836120893501968*^9}, {3.836120990035062*^9, 
   3.836121082712041*^9}, {3.836121120692807*^9, 3.836121145981134*^9}, {
   3.836121178442903*^9, 3.836121217955391*^9}, {3.8361214545210943`*^9, 
   3.836121503554632*^9}, {3.8361335426923943`*^9, 3.836133595409731*^9}, 
   3.83619005779554*^9, {3.836190151402268*^9, 3.836190181029146*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"940df120-27da-4d5b-b054-46ab1a6c1e95"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"p0", "-", "p3"}], 
      RowBox[{
       RowBox[{"-", "p1"}], "+", 
       RowBox[{"\[ImaginaryI]", " ", "p2"}]}]},
     {
      RowBox[{
       RowBox[{"-", "p1"}], "-", 
       RowBox[{"\[ImaginaryI]", " ", "p2"}]}], 
      RowBox[{"p0", "+", "p3"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8361901632669363`*^9, 3.836190197349481*^9}, 
   3.836190696284607*^9, 3.836190861895501*^9, 3.836355544026002*^9, 
   3.836355804248335*^9, 3.8363560743612747`*^9},
 CellLabel->
  "Out[51]//MatrixForm=",ExpressionUUID->"d28a2330-fe28-46eb-a51d-\
12e6db19b2ac"]
}, Open  ]],

Cell["Next we find the dispersion:", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5Ecz2ddApEt53iOg+i3dy+XwLRKzOTboPoilmukpeA9KZn
bVIg2vxB0vzPQPqp9MZVIPpUsNMWEK2ZXbgDRK9yun8ARMft5j4MogHdkb3n

  "],
 CellID->531348251,ExpressionUUID->"ab1ae230-975e-4dc5-94a8-6524960961e1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Det", "[", "EqWeyl", "]"}], "\[Equal]", "0"}], ",", "p0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8361205597683477`*^9, 3.836120586625532*^9}, {
   3.836120879554139*^9, 3.836120893501968*^9}, {3.836120990035062*^9, 
   3.836121082712041*^9}, {3.836121120692807*^9, 3.836121145981134*^9}, {
   3.836121178442903*^9, 3.836121217955391*^9}, {3.8361214545210943`*^9, 
   3.836121503554632*^9}, {3.8361335426923943`*^9, 3.836133595409731*^9}, 
   3.83619005779554*^9, {3.836190151402268*^9, 3.836190181029146*^9}, {
   3.836190237559576*^9, 3.836190263668981*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"d2af56e7-8fc3-41cd-a27e-f83bbadea4be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p0", "\[Rule]", 
     RowBox[{"-", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"p0", "\[Rule]", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8361901632669363`*^9, 3.836190197349481*^9}, {
   3.836190255701894*^9, 3.836190264028388*^9}, 3.8361906963082848`*^9, 
   3.8361908619240503`*^9, 3.836355544053816*^9, 3.836355804293741*^9, 
   3.836356074446599*^9},
 CellLabel->"Out[52]=",ExpressionUUID->"27575b88-ab18-4dc1-89a4-2bf5a15b06e4"]
}, Open  ]],

Cell["\<\
Now we find the right-handed Weyl spinor and normalize it to 1:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5Ecz2ddApEt53iOg+i3dy+XwLRKzOTboPoilmukpeA9KZn
bVIg2vxB0vzPQPqp9MZVIPpUsNMWEK2ZXbgDRK9yun8ARMft5j4MolO+mJ0G
0Sw9pmdBtG90/FUQ7a0YexNEAwDMoNAi
  "],
 CellID->503673192,ExpressionUUID->"653c4bd0-7e34-48bd-978d-fb44a18fbc74"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EqWeyl", "/.", 
   RowBox[{"p0", "\[Rule]", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["p1", "2"], "+", 
      SuperscriptBox["p2", "2"], "+", 
      SuperscriptBox["p3", "2"]}]]}]}], "//", 
  "NullSpace"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uR", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Normalize", "@", 
      RowBox[{"First", "[", "%", "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", "\[Element]", "Reals"}], ",", 
       RowBox[{"p2", "\[Element]", "Reals"}], ",", 
       RowBox[{"p3", "\[Element]", "Reals"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8361205597683477`*^9, 3.836120586625532*^9}, {
   3.836120879554139*^9, 3.836120893501968*^9}, {3.836120990035062*^9, 
   3.836121082712041*^9}, {3.836121120692807*^9, 3.836121145981134*^9}, {
   3.836121178442903*^9, 3.836121217955391*^9}, {3.8361214545210943`*^9, 
   3.836121503554632*^9}, {3.8361335426923943`*^9, 3.836133595409731*^9}, 
   3.83619005779554*^9, {3.836190151402268*^9, 3.836190181029146*^9}, {
   3.836190237559576*^9, 3.836190263668981*^9}, {3.836190397275035*^9, 
   3.836190593358589*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"ee6d4f7d-7177-4ff0-b73c-06e859e2ec0b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "p3"}], "-", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}]]}], 
      RowBox[{"p1", "+", 
       RowBox[{"\[ImaginaryI]", " ", "p2"}]}]]}], ",", "1"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8361901632669363`*^9, 3.836190197349481*^9}, {
   3.836190255701894*^9, 3.836190264028388*^9}, 3.836190425757859*^9, {
   3.836190458244762*^9, 3.836190594703602*^9}, 3.836190696332185*^9, 
   3.836190861951439*^9, 3.836355544084098*^9, 3.8363558043467493`*^9, 
   3.83635607451478*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"048f2823-bcae-4f3b-96de-9d3be69f40c8"]
}, Open  ]],

Cell["\<\
Finally we calculate the Berry potential and check that it indeed gives the \
monopole at the coordinate origin:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJwdx00og3EAx/FhXpqoHdbyDFns4KCYEOVgtXlsuRgbeZk2lpdY2w7kpYRm
ZU2GZAcuDraU6DksLpqLJlsm1kIUc9oOtqfEQf6/5/Dt01dqtHSNZvN4PIoE
0wVFj4vbyTadpS8GKfmMO0xMdZdtwE3TmBeWJ/cOYY7BdQSznDIGuu0Dcbhs
jT1zn8t+wN53UYKTViZhO33PjxBXba3FsPQnLoQ2n5qCv7vmCsjsi+ugpHm9
BXrk9Aqn5noN1uw4tXfEqa+UDuorRTa4MFxrh3SVcw5q85h5uBTYOoZmz/kJ
FCQ8IegICSJQpfqOQt+48QnOepUlUeLZp4OCTW/GgwwxITn1w5BWwcDqSWsA
+hWvl3DoovAKjrCNN5DvariFnf2GB6iRDsahNdORhurpHhYGJ0z5LPEvWC+E
bplfDPUvYc5/lonsKA==
  "],
 CellID->739798405,ExpressionUUID->"a3ca1b08-800c-47a8-8c09-c8bc75b51247"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{
      RowBox[{"dagger", "[", "uR", "]"}], ".", 
      RowBox[{"D", "[", 
       RowBox[{"uR", ",", "#"}], "]"}]}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Curl", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "]"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.8361205597683477`*^9, 3.836120586625532*^9}, {
   3.836120879554139*^9, 3.836120893501968*^9}, {3.836120990035062*^9, 
   3.836121082712041*^9}, {3.836121120692807*^9, 3.836121145981134*^9}, {
   3.836121178442903*^9, 3.836121217955391*^9}, {3.8361214545210943`*^9, 
   3.836121503554632*^9}, {3.8361335426923943`*^9, 3.836133595409731*^9}, 
   3.83619005779554*^9, {3.836190151402268*^9, 3.836190181029146*^9}, {
   3.836190237559576*^9, 3.836190263668981*^9}, {3.836190397275035*^9, 
   3.836190593358589*^9}, {3.8361906443492603`*^9, 3.836190650815854*^9}, {
   3.836190761765189*^9, 3.836190773097567*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"2f0df5ad-7c07-4b24-8ffe-51601f82cf2f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"p2", "+", 
     FractionBox[
      RowBox[{"p2", " ", "p3"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"]}], ")"}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"p1", "+", 
      FractionBox[
       RowBox[{"p1", " ", "p3"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}]]]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"]}], ")"}]}]]}], ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8361901632669363`*^9, 3.836190197349481*^9}, {
   3.836190255701894*^9, 3.836190264028388*^9}, 3.836190425757859*^9, {
   3.836190458244762*^9, 3.836190594703602*^9}, 3.836190651797142*^9, 
   3.836190696361565*^9, {3.83619076830193*^9, 3.836190773477763*^9}, 
   3.8361908619907227`*^9, 3.836355545172312*^9, 3.836355805567895*^9, 
   3.8363560756128607`*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"01583bfd-e51d-497c-b9fc-343416080850"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["p1", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]], ",", 
   FractionBox["p2", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]], ",", 
   FractionBox["p3", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8361901632669363`*^9, 3.836190197349481*^9}, {
   3.836190255701894*^9, 3.836190264028388*^9}, 3.836190425757859*^9, {
   3.836190458244762*^9, 3.836190594703602*^9}, 3.836190651797142*^9, 
   3.836190696361565*^9, {3.83619076830193*^9, 3.836190773477763*^9}, 
   3.8361908619907227`*^9, 3.836355545172312*^9, 3.836355805567895*^9, 
   3.83635607566532*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"ad895a62-9a98-408b-b231-c8504d792449"]
}, Open  ]],

Cell["\<\


Let us now check that the Dirac spinor transforms correctly under Lorentz \
transformations. For simplicity we consider a Lorentz boost in z-direction \
and parametrize it with an anti-symmetric tensor:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5ELzoYWXAJSH87f6UERL/ZvWguiJaIWrcERP8s+b4SRLvs
F14Doj9d6NgGop/deAqmhS7OjrkM8ueuBWB6w8PY8i8g+bh8MA0AvBvBrg==

  "],
 CellID->1999901332,ExpressionUUID->"73f85b09-90e3-486d-9d92-e0df2a011cc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w", "[", 
   RowBox[{
    RowBox[{"-", "\[Mu]"}], ",", 
    RowBox[{"-", "\[Nu]"}]}], "]"}], "\[Congruent]", 
  RowBox[{"(", GridBox[{
     {"0", "0", "0", 
      RowBox[{"Log", "[", 
       FractionBox[
        RowBox[{"1", "+", "v"}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["v", "2"]}]]], "]"}]},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {
      RowBox[{"-", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"1", "+", "v"}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["v", "2"]}]]], "]"}]}], "0", "0", "0"}
    }], ")"}]}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, 
   3.836116034403319*^9, {3.8361161039022207`*^9, 3.8361161163380404`*^9}, {
   3.836117269695117*^9, 3.83611727327763*^9}, {3.836117490355998*^9, 
   3.836117491045287*^9}, {3.836117692013042*^9, 3.836117695454706*^9}, {
   3.836117780004839*^9, 3.836117790514974*^9}, {3.836118075471648*^9, 
   3.836118079260954*^9}, {3.836118335155142*^9, 3.8361183441563387`*^9}, {
   3.8361191559241877`*^9, 3.836119186837718*^9}, 3.836119520916081*^9, {
   3.836119603684318*^9, 3.83611960382892*^9}, 3.8361224172709713`*^9, {
   3.836122469356258*^9, 3.836122515694672*^9}, {3.836122912241064*^9, 
   3.836122965023288*^9}, {3.836122999517646*^9, 3.836123001728346*^9}, {
   3.83612310750343*^9, 3.836123152614827*^9}, {3.836123195058556*^9, 
   3.836123207195641*^9}},
 CellLabel->"In[57]:=",
 CellID->939843114,ExpressionUUID->"de2cc48d-d4ae-476e-8c63-836a2ac140a2"],

Cell["\<\
Lorentz 4-vectors transform using the following representation of the Lorentz \
group:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5ELzoYWXAJSH87f6UERL/ZvWguiJaIWrcERP8s+b4SRLvs
F14Doj9d6NgGlo+t3g2i7VcxHAbRTqxnj4HoOT4MmpeB9Ku3RWAaAFcOvhg=

  "],
 CellID->433768664,ExpressionUUID->"39e3e07d-93a4-4a95-a5e5-598dd17ddf5e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"J", "[", 
   RowBox[{"\[Mu]", ",", "\[Nu]", ",", 
    RowBox[{"-", "\[Alpha]"}], ",", 
    RowBox[{"-", "\[Beta]"}]}], "]"}], "\[Congruent]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        TemplateBox[{RowBox[{"\[Mu]", ",", "\[Alpha]"}]},
         "KroneckerDeltaSeq"], 
        TemplateBox[{RowBox[{"\[Nu]", ",", "\[Beta]"}]},
         "KroneckerDeltaSeq"]}], "-", 
       RowBox[{
        TemplateBox[{RowBox[{"\[Mu]", ",", "\[Beta]"}]},
         "KroneckerDeltaSeq"], 
        TemplateBox[{RowBox[{"\[Nu]", ",", "\[Alpha]"}]},
         "KroneckerDeltaSeq"]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Mu]", ",", "0", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Nu]", ",", "0", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "0", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Beta]", ",", "0", ",", "3"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalLambda]vec", "=", 
   RowBox[{
    RowBox[{"MatrixExp", "@", 
     RowBox[{"GetArray", "[", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       RowBox[{"w", "[", 
        RowBox[{
         RowBox[{"-", "\[Mu]"}], ",", 
         RowBox[{"-", "\[Nu]"}]}], "]"}], 
       RowBox[{"J", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", 
         RowBox[{"-", "\[Beta]"}]}], "]"}]}], "]"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pnew", "=", 
  RowBox[{
   RowBox[{"\[CapitalLambda]vec", ".", 
    RowBox[{"GetArray", "[", 
     RowBox[{"p", "[", "\[Mu]", "]"}], "]"}]}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, 
   3.836116034403319*^9, {3.8361161039022207`*^9, 3.8361161163380404`*^9}, {
   3.836117269695117*^9, 3.83611727327763*^9}, {3.836117490355998*^9, 
   3.836117491045287*^9}, {3.836117692013042*^9, 3.836117695454706*^9}, {
   3.836117780004839*^9, 3.836117790514974*^9}, {3.836118075471648*^9, 
   3.836118079260954*^9}, {3.836118335155142*^9, 3.8361183441563387`*^9}, {
   3.8361191559241877`*^9, 3.836119186837718*^9}, 3.836119520916081*^9, {
   3.836119603684318*^9, 3.83611960382892*^9}, 3.8361224172709713`*^9, {
   3.836122469356258*^9, 3.836122515694672*^9}, {3.836122689501521*^9, 
   3.836122805175*^9}, {3.836123018017068*^9, 3.8361230226582413`*^9}, {
   3.836123164359923*^9, 3.8361231703468933`*^9}, {3.836123628955246*^9, 
   3.836123629950629*^9}, {3.836123813646132*^9, 3.836123815016611*^9}, {
   3.83613293907148*^9, 3.836132964721961*^9}, {3.8361331147079678`*^9, 
   3.8361331160553207`*^9}},
 CellLabel->"In[58]:=",
 CellID->43101963,ExpressionUUID->"e5b1f425-2e64-40b8-92b8-acfb63c1c9d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"p0", "+", 
     RowBox[{"p3", " ", "v"}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["v", "2"]}]]], ",", "p1", ",", "p2", ",", 
   FractionBox[
    RowBox[{"p3", "+", 
     RowBox[{"p0", " ", "v"}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["v", "2"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.836122775193061*^9, 3.836122805703618*^9}, {
   3.8361229224630003`*^9, 3.836122967996956*^9}, {3.836123006785624*^9, 
   3.8361230262545843`*^9}, 3.8361231115682783`*^9, {3.836123156319866*^9, 
   3.836123170800302*^9}, 3.836123210388562*^9, 3.8361236483456507`*^9, 
   3.836123815496565*^9, 3.836132966177144*^9, 3.836133116419524*^9, 
   3.8361334536888533`*^9, {3.836188386723144*^9, 3.8361884019707203`*^9}, 
   3.836190070588561*^9, {3.8361901719695807`*^9, 3.836190197388489*^9}, 
   3.836190696399489*^9, 3.8361908620323267`*^9, 3.836355545349139*^9, 
   3.8363558057104263`*^9, 3.8363560757346697`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"41512b13-c63e-4fb5-ac94-5b33e41242e2"]
}, Open  ]],

Cell[TextData[{
 "Dirac spinors transform under ",
 Cell[BoxData[
  FormBox[
   FractionBox["1", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "09df66e0-b9aa-49df-9a9d-86b2cccfec2f"],
 "\[Sigma][\[Mu],\[Nu]] matrix representation. We check the result by \
calculating the current for the transformed spinor:"
}], "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5ELzoYWXAJSH87f6UERL/ZvWguiJaIWrcERP8s+b4SRLvs
F14Doj9d6NgGlo+t3g2i7VcxHAbRTqxnj4Fob/mZQpeB9KzSt5Ig2mxdhzqI
/rVrFZhe90wrHkQvsxBJB9EAOrHPnw==
  "],
 CellID->1069281746,ExpressionUUID->"aaacf810-198f-4891-b73a-7ecb53c19143"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalLambda]sp", "=", 
   RowBox[{
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["\[ImaginaryI]", "2"]}], 
       RowBox[{"w", "[", 
        RowBox[{
         RowBox[{"-", "\[Mu]"}], ",", 
         RowBox[{"-", "\[Nu]"}]}], "]"}], "*", 
       FractionBox["1", "2"], 
       RowBox[{"\[Sigma]", "[", 
        RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], "//", "GetArray"}], "]"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]new", "=", 
   RowBox[{
    RowBox[{"\[CapitalLambda]sp", ".", "\[Psi]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bar", "[", "\[Psi]new", "]"}], ".", 
    RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}], ".", "\[Psi]new"}], "//", 
   "GetArray"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "\[Equal]", 
    RowBox[{"2", "pnew"}]}], "/.", 
   RowBox[{"p0", "\[Rule]", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["p1", "2"], "+", 
      SuperscriptBox["p2", "2"], "+", 
      SuperscriptBox["p3", "2"]}]]}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, 
   3.836116034403319*^9, {3.8361161039022207`*^9, 3.8361161163380404`*^9}, {
   3.836117269695117*^9, 3.83611727327763*^9}, {3.836117490355998*^9, 
   3.836117491045287*^9}, {3.836117692013042*^9, 3.836117695454706*^9}, {
   3.836117780004839*^9, 3.836117790514974*^9}, {3.836118075471648*^9, 
   3.836118079260954*^9}, {3.836118335155142*^9, 3.8361183441563387`*^9}, {
   3.8361191559241877`*^9, 3.836119186837718*^9}, 3.836119520916081*^9, {
   3.836119603684318*^9, 3.83611960382892*^9}, 3.8361224172709713`*^9, {
   3.836122469356258*^9, 3.836122515694672*^9}, {3.836122689501521*^9, 
   3.836122805175*^9}, {3.836123018017068*^9, 3.8361230226582413`*^9}, {
   3.836123164359923*^9, 3.8361231703468933`*^9}, {3.8361233494350147`*^9, 
   3.836123355044324*^9}, {3.83612338939194*^9, 3.836123511098012*^9}, {
   3.83612362545242*^9, 3.8361236666686773`*^9}, {3.836132576312101*^9, 
   3.836132583099918*^9}, {3.8361328192577763`*^9, 3.836132844795209*^9}, {
   3.836132971627747*^9, 3.836132974545857*^9}, {3.836133102005694*^9, 
   3.836133103796876*^9}},
 CellLabel->"In[61]:=",
 CellID->1754108683,ExpressionUUID->"ef2c8774-48b4-4d6a-8e9e-00bf53bdb24e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["m", "2"], "+", 
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}]], "+", 
       RowBox[{"p3", " ", "v"}]}], ")"}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["v", "2"]}]]], ",", 
   RowBox[{"2", " ", "p1"}], ",", 
   RowBox[{"2", " ", "p2"}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"p3", "+", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}]], " ", "v"}]}], ")"}]}], 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["v", "2"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.836122775193061*^9, 3.836122805703618*^9}, {
   3.8361229224630003`*^9, 3.836122967996956*^9}, {3.836123006785624*^9, 
   3.8361230262545843`*^9}, 3.8361231115682783`*^9, {3.836123156319866*^9, 
   3.836123170800302*^9}, 3.836123210388562*^9, {3.83612339922158*^9, 
   3.836123428158984*^9}, {3.8361234866273108`*^9, 3.8361235123171377`*^9}, 
   3.8361236670595016`*^9, 3.8361238173590508`*^9, 3.836132585042521*^9, 
   3.83613284728856*^9, 3.8361329768109426`*^9, 3.8361331041857967`*^9, 
   3.836133454232808*^9, {3.836188387264759*^9, 3.8361884025086327`*^9}, 
   3.836190070615048*^9, {3.836190171995418*^9, 3.8361901974165907`*^9}, 
   3.836190696487616*^9, 3.836190862060278*^9, 3.836355545986013*^9, 
   3.8363558063907213`*^9, 3.836356076368766*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"edf35adf-52b9-4542-b1cb-ce46713a7ec2"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.836122775193061*^9, 3.836122805703618*^9}, {
   3.8361229224630003`*^9, 3.836122967996956*^9}, {3.836123006785624*^9, 
   3.8361230262545843`*^9}, 3.8361231115682783`*^9, {3.836123156319866*^9, 
   3.836123170800302*^9}, 3.836123210388562*^9, {3.83612339922158*^9, 
   3.836123428158984*^9}, {3.8361234866273108`*^9, 3.8361235123171377`*^9}, 
   3.8361236670595016`*^9, 3.8361238173590508`*^9, 3.836132585042521*^9, 
   3.83613284728856*^9, 3.8361329768109426`*^9, 3.8361331041857967`*^9, 
   3.836133454232808*^9, {3.836188387264759*^9, 3.8361884025086327`*^9}, 
   3.836190070615048*^9, {3.836190171995418*^9, 3.8361901974165907`*^9}, 
   3.836190696487616*^9, 3.836190862060278*^9, 3.836355545986013*^9, 
   3.8363558063907213`*^9, 3.836356076370255*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"c5ab079e-fba4-4f19-8d34-9df2835b78b8"]
}, Open  ]],

Cell["\<\
We can also check the transformation properties of the Dirac matrices \
directly:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5ELzoYWXAJSH87f6UERL/ZvWguiJaIWrcERP8s+b4SRLvs
F14Doj9d6NgGlo+t3g2i7VcxHAbRTqxnj4Fob/mZQpeB9KzSt5Ig2mxdhzqI
/rVrFZhe90wrHkQvsxBJB9FJt2v7rwNp1clck0E0AINk2G4=
  "],
 CellID->2125123813,ExpressionUUID->"6764e151-ebba-4eea-be41-8f50ec3f5206"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetArray", "[", 
    RowBox[{
     RowBox[{"Inverse", "[", "\[CapitalLambda]sp", "]"}], ".", 
     RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}], ".", "\[CapitalLambda]sp"}], 
    "]"}], "==", 
   RowBox[{"\[CapitalLambda]vec", ".", 
    RowBox[{"GetArray", "[", 
     RowBox[{"\[Gamma]", "[", "\[Mu]", "]"}], "]"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, 
   3.836116034403319*^9, {3.8361161039022207`*^9, 3.8361161163380404`*^9}, {
   3.836117269695117*^9, 3.83611727327763*^9}, {3.836117490355998*^9, 
   3.836117491045287*^9}, {3.836117692013042*^9, 3.836117695454706*^9}, {
   3.836117780004839*^9, 3.836117790514974*^9}, {3.836118075471648*^9, 
   3.836118079260954*^9}, {3.836118335155142*^9, 3.8361183441563387`*^9}, {
   3.8361191559241877`*^9, 3.836119186837718*^9}, 3.836119520916081*^9, {
   3.836119603684318*^9, 3.83611960382892*^9}, 3.8361224172709713`*^9, {
   3.836122469356258*^9, 3.836122515694672*^9}, {3.836122689501521*^9, 
   3.836122805175*^9}, {3.836123018017068*^9, 3.8361230226582413`*^9}, {
   3.836123164359923*^9, 3.8361231703468933`*^9}, {3.8361233494350147`*^9, 
   3.836123355044324*^9}, {3.83612338939194*^9, 3.836123511098012*^9}, {
   3.83612362545242*^9, 3.8361236666686773`*^9}, {3.8361325303194437`*^9, 
   3.836132554969844*^9}, {3.836132591439294*^9, 3.836132619708838*^9}, {
   3.83613269856485*^9, 3.836132790112094*^9}, {3.836132851687725*^9, 
   3.8361328736238527`*^9}, {3.836132913256542*^9, 3.836132921793108*^9}, {
   3.836132980468462*^9, 3.836133090353097*^9}, {3.836133164717464*^9, 
   3.836133169689107*^9}, {3.836133217694584*^9, 3.836133217879562*^9}, {
   3.836133274195589*^9, 3.8361333330204067`*^9}, {3.836133366127644*^9, 
   3.8361333892159233`*^9}},
 CellLabel->"In[65]:=",
 CellID->1874828429,ExpressionUUID->"586e77a3-0f4a-4436-b412-f986331567b4"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.836122775193061*^9, 3.836122805703618*^9}, {
   3.8361229224630003`*^9, 3.836122967996956*^9}, {3.836123006785624*^9, 
   3.8361230262545843`*^9}, 3.8361231115682783`*^9, {3.836123156319866*^9, 
   3.836123170800302*^9}, 3.836123210388562*^9, {3.83612339922158*^9, 
   3.836123428158984*^9}, {3.8361234866273108`*^9, 3.8361235123171377`*^9}, 
   3.8361236670595016`*^9, 3.8361238173590508`*^9, {3.836132703646385*^9, 
   3.83613274395895*^9}, {3.836132774599745*^9, 3.836132790478745*^9}, {
   3.8361328585536003`*^9, 3.836132873938163*^9}, 3.8361329223778276`*^9, {
   3.836132996405405*^9, 3.836133090858127*^9}, 3.8361331702212543`*^9, 
   3.836133218410799*^9, {3.8361332825449953`*^9, 3.836133333502005*^9}, {
   3.836133376112866*^9, 3.836133389630351*^9}, 3.8361334542536383`*^9, {
   3.83618838733187*^9, 3.836188402550668*^9}, 3.83619007063765*^9, {
   3.836190172022485*^9, 3.836190197444558*^9}, 3.836190696512528*^9, 
   3.836190862084399*^9, 3.836355546025715*^9, 3.836355806518071*^9, 
   3.836356076405147*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"a5d62979-a24e-4c7f-b374-785af5be95ef"]
}, Open  ]],

Cell["\<\
Lastly we clear the Minkowski space to not interfere with the next chapter:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQ/YmD91rtlDeOYfmR10G0lFF53zkg/TZEth9ET0zO
mAWi5d7MXAKimeN7VoBoxg7VLSC6rzjmJohuKrx+B8xn/fIEREc8Fn0Kpj1c
34Bod4/LLOeBdEuRLR+Ilvl5UxBEF630kgLRv6anKYDoLfPEDUG0tGW3FYie
ZOTRDKa9T7SDaN2pHcEXgXTux7dhIDpcWbQIRNckGBSDaA+VjioQHcy2pRpE
N+yYvAZEp03atR5ELzoYWXAJSH87f6UERL/ZvWguiJaIWrcERP8s+b4SRLvs
F14Doj9d6NgGlo+t3g2i7VcxHAbRTqxnj4Fob/mZQpeB9KzSt5Ig2mxdhzqI
/rVrFZhe90wrHkQvsxBJB9FJt2v7rwNp1clck0G0yf/2sM9AupPbPQpEAwBX
guEc
  "],
 CellID->1370627916,ExpressionUUID->"8e592689-456f-4760-850d-2940218cc7fc"],

Cell[BoxData[
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Minkowski\>\"", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, 
   3.836116034403319*^9, {3.8361161039022207`*^9, 3.8361161163380404`*^9}, {
   3.836117269695117*^9, 3.83611727327763*^9}, {3.836117490355998*^9, 
   3.836117491045287*^9}, {3.836117692013042*^9, 3.836117695454706*^9}, {
   3.836117780004839*^9, 3.836117790514974*^9}, {3.836118075471648*^9, 
   3.836118079260954*^9}, {3.836118335155142*^9, 3.8361183441563387`*^9}, {
   3.8361191559241877`*^9, 3.836119186837718*^9}, 3.836119520916081*^9, {
   3.836119603684318*^9, 3.83611960382892*^9}, 3.8361224172709713`*^9, {
   3.836122469356258*^9, 3.836122515694672*^9}, {3.836122689501521*^9, 
   3.836122805175*^9}, {3.836123018017068*^9, 3.8361230226582413`*^9}, {
   3.836123164359923*^9, 3.8361231703468933`*^9}, {3.8361233494350147`*^9, 
   3.836123355044324*^9}, {3.83612338939194*^9, 3.836123511098012*^9}, {
   3.83612362545242*^9, 3.8361236666686773`*^9}, {3.8361325303194437`*^9, 
   3.836132554969844*^9}, {3.836132591439294*^9, 3.836132619708838*^9}, {
   3.83613269856485*^9, 3.836132790112094*^9}, {3.836132851687725*^9, 
   3.8361328736238527`*^9}, {3.836132913256542*^9, 3.836132921793108*^9}, {
   3.836132980468462*^9, 3.836133090353097*^9}, {3.836133164717464*^9, 
   3.836133169689107*^9}, {3.836133217694584*^9, 3.836133217879562*^9}, {
   3.836133274195589*^9, 3.8361333330204067`*^9}, {3.836133366127644*^9, 
   3.8361333892159233`*^9}, 3.836189407346874*^9, {3.8361901911798077`*^9, 
   3.836190193502598*^9}, {3.836190691258875*^9, 3.836190693209181*^9}},
 CellLabel->"In[66]:=",
 CellID->607365897,ExpressionUUID->"013f4d2e-c987-492e-a1aa-fb8f53efdd35"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Chiral Kinetic Theory\
\>", "Chapter",
 CellChangeTimes->{{3.835948771728477*^9, 3.835948777532579*^9}, {
   3.836112067136997*^9, 3.836112083330764*^9}, 
   3.836114545205564*^9},ExpressionUUID->"1aed5b35-83bb-49b3-88c8-\
c20b6996d8f6"],

Cell["\<\
In this chapter we will examine applications of SimpleTensor to elementary \
differential geometric calculations on the example of chiral kinetic theory. \
This chapter is based mostly on the excellent papers by Stephanov, Yin, and \
others [Phys. Rev. Lett. 109, 162001] and [Phys. Rev. Lett. 113, 182302]. \
Note, that because of the partially deliberate lack of optimization in favor \
of package code clarity, calculations in this chapter can take a few minutes.\
\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
  3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
  3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
  3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
  3.836189690815984*^9, 3.8361897061934853`*^9}, {3.836191274457138*^9, 
  3.836191333956478*^9}, {3.836191375641609*^9, 3.836191376629171*^9}, {
  3.836191406727642*^9, 3.836191409287269*^9}, {3.83619154151682*^9, 
  3.836191555821018*^9}, {3.836193676337879*^9, 3.836193730117957*^9}, {
  3.836247841538027*^9, 3.8362479687884502`*^9}},
 CellID->913191182,ExpressionUUID->"982e411a-e0ac-49dd-a77f-79419687cf9b"],

Cell["\<\
In its simplest form chiral particles are living in the Euclidean phase space \
- a product of 3-dimensional spatial and momentum spaces, coupled to a \
1-dimensional time space. Therefore we define:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.836189690815984*^9, 3.8361897061934853`*^9}, {3.836191274457138*^9, 
   3.836191333956478*^9}, {3.836191375641609*^9, 3.836191376629171*^9}, {
   3.836191406727642*^9, 3.836191409287269*^9}, {3.83619154151682*^9, 
   3.836191555821018*^9}, {3.836193676337879*^9, 3.836193730117957*^9}, 
   3.836247844347707*^9},ExpressionUUID->"c1369ea6-a9b2-406c-895c-\
a366225312ae"],

Cell[BoxData[{
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Spatial\>\"", ",", "3", ",", 
   RowBox[{"index", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "}"}]}], ",", 
   RowBox[{"coord", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Momentum\>\"", ",", "3", ",", 
   RowBox[{"index", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}]}], ",", 
   RowBox[{"coord", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DefineSpace", "[", 
   RowBox[{"\"\<Time\>\"", ",", "1", ",", 
    RowBox[{"index", "\[Rule]", 
     RowBox[{"{", "z", "}"}]}], ",", 
    RowBox[{"coord", "\[Rule]", 
     RowBox[{"{", "t", "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "[", 
   RowBox[{
    RowBox[{"-", "i"}], ",", 
    RowBox[{"-", "j"}]}], "]"}], "\[Congruent]", 
  RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "[", 
   RowBox[{
    RowBox[{"-", "a"}], ",", 
    RowBox[{"-", "b"}]}], "]"}], "\[Congruent]", 
  RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.836189655633312*^9, 3.8361896557827883`*^9}, {
   3.8361897164255342`*^9, 3.836189721101879*^9}},
 CellLabel->"In[67]:=",
 CellID->671962100,ExpressionUUID->"ee0e8708-dc20-49ea-aaaa-11ef6f445f1e"],

Cell["\<\
Next we define in the spatial space a momentum vector and in the momentum \
space a Berry potential vector that was derived in previous chapter:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
  3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
  3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
  3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
  3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
  3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
  3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
  3.836190947744082*^9}, {3.836191722707327*^9, 3.8361917231565638`*^9}},
 CellID->1968582900,ExpressionUUID->"9e2e1f91-9f4d-47c0-9204-cb397fe494a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p", "[", "i", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ap", "[", "a", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"p2", "+", 
      FractionBox[
       RowBox[{"p2", " ", "p3"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}]]]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"]}], ")"}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"p1", "+", 
       FractionBox[
        RowBox[{"p1", " ", "p3"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}]]]}], 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"]}], ")"}]}]]}], ",", "0"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.836211218676711*^9, 3.836211243610711*^9}},
 CellLabel->"In[72]:=",
 CellID->496046602,ExpressionUUID->"0ec404cc-3cc8-466e-a930-723f43b51eb5"],

Cell["\<\
Let us also introduce a uniform electric and magnetic fields both pointing in \
the z-direction. We therefore define the following electromagnetic potential:\
\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
  3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
  3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
  3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
  3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
  3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
  3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
  3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
  3.8361917747669363`*^9, 3.836191853482462*^9}},
 CellID->690768034,ExpressionUUID->"5df9288a-4ee8-49e4-aa5f-22730074bca5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]", "=", 
   RowBox[{"Ez", " ", "z"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "[", "i", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], "Bz", " ", "y"}], ",", 
    RowBox[{
     FractionBox["1", "2"], "Bz", " ", "x"}], ",", "0"}], "}"}]}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, 3.8361924040595093`*^9, 
   3.836212064281906*^9},
 CellLabel->"In[74]:=",
 CellID->276958412,ExpressionUUID->"058d5118-0735-48a9-a38a-70206ee41b78"],

Cell["\<\
The dispersion of a chiral particle gets modified by the presence of the \
magnetic field due to its interaction with its spin:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
  3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
  3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
  3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
  3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
  3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
  3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
  3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
  3.8361917747669363`*^9, 3.836191853482462*^9}, {3.836192438103702*^9, 
  3.836192533949189*^9}, {3.836241828960271*^9, 3.836241844988126*^9}},
 CellID->1448011921,ExpressionUUID->"57f99943-9a89-4148-bd4a-b4db67a67cc7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Epsilon]", "=", 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["p1", "2"], "+", 
      SuperscriptBox["p2", "2"], "+", 
      SuperscriptBox["p3", "2"]}]], "-", 
    FractionBox[
     RowBox[{"\[HBar]", " ", "p3", " ", "Bz"}], 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, 3.8361924040595093`*^9, {
   3.8361925372804117`*^9, 3.836192591007907*^9}, {3.8362100962061567`*^9, 
   3.836210102784314*^9}, {3.836210982576796*^9, 3.836210985515123*^9}, {
   3.836225435468111*^9, 3.836225466866453*^9}, {3.836238911882783*^9, 
   3.836238914453958*^9}, {3.8362421002661457`*^9, 3.836242100585597*^9}},
 CellLabel->"In[76]:=",
 CellID->200430814,ExpressionUUID->"bc076a32-b801-43c9-8521-d8401c27b669"],

Cell["\<\
Now we have all ingredients to define the Lagrangian 1-form of a chiral \
particle:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
  3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
  3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
  3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
  3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
  3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
  3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
  3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
  3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
  3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
  3.836192151087016*^9}},
 CellID->32490493,ExpressionUUID->"4be940f6-b551-4a10-90bb-bad1dbc73d18"],

Cell[BoxData[
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"-", "i"}], "]"}], "+", 
        RowBox[{"A", "[", 
         RowBox[{"-", "i"}], "]"}]}], ")"}], 
      RowBox[{"basis", "[", "i", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Epsilon]", "-", "\[Phi]"}], ")"}], "dt"}], "-", 
     RowBox[{"\[HBar]", " ", 
      RowBox[{"ap", "[", 
       RowBox[{"-", "a"}], "]"}], 
      RowBox[{"basis", "[", "a", "]"}]}]}], "//", "GetArray"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, {3.8361921566094627`*^9, 
   3.836192156958659*^9}, {3.836192201781852*^9, 3.836192333205892*^9}, {
   3.836192595838347*^9, 3.836192605954053*^9}, {3.8362118656095743`*^9, 
   3.836211865782791*^9}, 3.8362121669376163`*^9, {3.836225471219756*^9, 
   3.836225471584669*^9}, {3.836245357186778*^9, 3.836245361437571*^9}, 
   3.836245487583159*^9},
 CellLabel->"In[77]:=",
 CellID->596704046,ExpressionUUID->"5deca3e2-4b35-435c-96ed-096d5d837e34"],

Cell["\<\
Let us prove that this Lagrangian is indeed Lorentz invariant, at least up to \
the second order in \[HBar]. Let us for simplicity consider a boost in the \
z-direction. In this case the electric and magnetic fields do not change and \
therefore the Lagrangian is invariant with respect to the transformation if \
its Lie derivative with the vector field that generates this transformation \
is zero.  The vector field of the Lorentz transformation is then:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.8362424311973553`*^9, 3.836242471876918*^9}, {3.8362425020606203`*^9, 
   3.836242505402383*^9}, {3.836242546905058*^9, 3.836242573308776*^9}, {
   3.836242693341958*^9, 3.836242803165058*^9}, {3.8362429638845377`*^9, 
   3.83624298567985*^9}, {3.836243022686015*^9, 3.8362430657823*^9}, {
   3.836243105467576*^9, 3.8362431149667797`*^9}},
 CellID->1506478874,ExpressionUUID->"92fa8d12-044f-49de-ab93-13b558076b34"],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Beta]3"}], "}"}]}], ",", 
     RowBox[{"xvec", "=", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ",", 
     RowBox[{"pvec", "=", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], ",", 
     RowBox[{"Bvec", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "Bz"}], "}"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"jump", "=", 
       RowBox[{"\[HBar]", 
        FractionBox[
         RowBox[{"\[Beta]", "\[Cross]", "pvec"}], 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["p1", "2"], "+", 
            SuperscriptBox["p2", "2"], "+", 
            SuperscriptBox["p3", "2"]}], ")"}]}]]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Delta]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Beta]", ".", "xvec"}], " ", "\[Eth]t"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", " ", "\[Beta]"}], "+", "jump"}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{"\[Eth]x", ",", "\[Eth]y", ",", "\[Eth]z"}], "}"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Epsilon]", " ", "\[Beta]"}], "+", 
           RowBox[{"jump", "\[Cross]", "Bvec"}]}], ")"}], ".", 
         RowBox[{"{", 
          RowBox[{"\[Eth]p1", ",", "\[Eth]p2", ",", "\[Eth]p3"}], "}"}]}]}]}],
       ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.836243124778166*^9, 3.836243176339589*^9}, {
   3.836243206735567*^9, 3.8362432627724533`*^9}, {3.836243303355625*^9, 
   3.836243384278674*^9}, {3.836243447792117*^9, 3.836243498113291*^9}, {
   3.836243604789804*^9, 3.836243604940847*^9}, {3.83624364074289*^9, 
   3.836243643842844*^9}, {3.836243699397951*^9, 3.836243725907498*^9}, {
   3.836243760395927*^9, 3.836243775511319*^9}, {3.836243837521966*^9, 
   3.836243851798212*^9}, 3.836244474549871*^9},
 CellLabel->"In[78]:=",ExpressionUUID->"6f4c1b49-e763-452e-8de3-fd954adca23c"],

Cell[TextData[{
 "Here the jump term denotes the so-called side-jump, i.e., position of a \
chiral particle depends on the Lorentz frame. Now we define the Lie \
derivative using the Cartan formula and show that the Lagrangian is invariant \
(up to an irrelevant total derivative and up to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[HBar]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "97001021-c861-4913-910d-9d4dd62a6174"],
 ") to the transformation generated by the boost \[Delta]."
}], "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.83624387258302*^9, 3.836243897204728*^9}, {3.836243943713978*^9, 
   3.8362441874145117`*^9}},
 CellID->1438994093,ExpressionUUID->"dad9304d-607e-4f2c-8bbb-1d2c23ee890c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"LieDerivative", "[", 
   RowBox[{"v_", ",", "f_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"InteriorProduct", "[", 
    RowBox[{"v", ",", 
     RowBox[{
      RowBox[{"ExteriorDerivative", "[", "]"}], "[", "f", "]"}]}], "]"}], "+", 
   RowBox[{
    RowBox[{"ExteriorDerivative", "[", "]"}], "[", 
    RowBox[{"InteriorProduct", "[", 
     RowBox[{"v", ",", "f"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LieDerivative", "[", 
   RowBox[{"\[Delta]", ",", "L"}], "]"}], "-", 
  RowBox[{
   RowBox[{"ExteriorDerivative", "[", "]"}], "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], "Ez", " ", "\[Beta]3", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["t", "2"], "+", 
       SuperscriptBox["z", "2"]}], ")"}]}], "+", 
    FractionBox[
     RowBox[{"Bz", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p1", " ", "x"}], "+", 
        RowBox[{"p2", " ", "y"}]}], ")"}], " ", "\[Beta]3", " ", "\[HBar]"}], 
     
     RowBox[{"4", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}]}]]}], "]"}], "+", 
  SuperscriptBox[
   RowBox[{"O", "[", "\[HBar]", "]"}], "2"]}]}], "Input",
 CellChangeTimes->{{3.836244235180966*^9, 3.836244274938099*^9}, {
   3.8362443104012814`*^9, 3.836244314884241*^9}, 3.836245410007111*^9, {
   3.836245492735814*^9, 3.8362454977677927`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"40053eb8-ef27-474f-b3f4-3f370c6bdd8c"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[HBar]", "]"}], "2"],
  SeriesData[$CellContext`\[HBar], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.836244303239205*^9, 3.836244339216084*^9, 
  3.836244502175007*^9, 3.8362454137525787`*^9, 3.8362455214350567`*^9, 
  3.836355552542774*^9, 3.836355852167747*^9, 3.83635611723776*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"60291401-9f9c-4ad0-9c7e-1860749d533d"]
}, Open  ]],

Cell["\<\
The Lagrangian 1-form (without the dt term) works as a soldering form in our \
phase space and glues the particle velocity with its momentum. The exterior \
derivative of a soldering form gives the symplectic form of the corresponding \
phase space. However, our Lagrangian has an extra time coordinate and a term \
connected to it. The exterior derivative dL gives what is called a \
pre-symplectic form - an odd-dimensional 2-form whose null vector gives the \
system evolution and the quotient space with respect to this vector gives the \
phase-space. The projection of dL to this phase space is the symplectic form. \
Let us therefore calculate the exterior derivative of L.\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.8362445473047247`*^9, 3.836244549477961*^9}, {3.836244611005443*^9, 
   3.836244650925395*^9}},
 CellID->859968897,ExpressionUUID->"ce5286ca-e9ad-421a-8c09-3129537ec374"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dL", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"ExteriorDerivative", "[", "]"}], "[", "L", "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, {3.8361921566094627`*^9, 
   3.836192156958659*^9}, {3.836192201781852*^9, 3.836192333205892*^9}, {
   3.836192595838347*^9, 3.836192605954053*^9}, {3.8362073968761253`*^9, 
   3.836207409440827*^9}, {3.8362074443656073`*^9, 3.8362074453057547`*^9}},
 CellLabel->"In[81]:=",
 CellID->1181245871,ExpressionUUID->"52d63625-87ae-4d39-b58e-e606d446a433"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dp1", "\[Wedge]", "dx"}], "+", 
  RowBox[{"dp2", "\[Wedge]", "dy"}], "+", 
  RowBox[{"dp3", "\[Wedge]", "dz"}], "-", 
  RowBox[{"Ez", " ", 
   RowBox[{"dt", "\[Wedge]", "dz"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"p3", " ", "\[HBar]", " ", 
        RowBox[{"dp1", "\[Wedge]", "dp2"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], "+", 
     FractionBox[
      RowBox[{"p2", " ", "\[HBar]", " ", 
       RowBox[{"dp1", "\[Wedge]", "dp3"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "-", 
     FractionBox[
      RowBox[{"2", " ", "p1", " ", 
       RowBox[{"dp1", "\[Wedge]", "dt"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]], "-", 
     FractionBox[
      RowBox[{"p1", " ", "\[HBar]", " ", 
       RowBox[{"dp2", "\[Wedge]", "dp3"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]], "-", 
     FractionBox[
      RowBox[{"2", " ", "p2", " ", 
       RowBox[{"dp2", "\[Wedge]", "dt"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]], "-", 
     FractionBox[
      RowBox[{"2", " ", "p3", " ", 
       RowBox[{"dp3", "\[Wedge]", "dt"}]}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]], "+", 
     FractionBox[
      RowBox[{"Bz", " ", "\[HBar]", " ", 
       RowBox[{"dp3", "\[Wedge]", "dt"}]}], 
      RowBox[{
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}]], "-", 
     FractionBox[
      RowBox[{"2", " ", "Bz", " ", "p3", " ", "\[HBar]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p1", " ", 
          RowBox[{"dp1", "\[Wedge]", "dt"}]}], "+", 
         RowBox[{"p2", " ", 
          RowBox[{"dp2", "\[Wedge]", "dt"}]}], "+", 
         RowBox[{"p3", " ", 
          RowBox[{"dp3", "\[Wedge]", "dt"}]}]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}], ")"}], "2"]], "+", 
     RowBox[{"2", " ", "Bz", " ", 
      RowBox[{"dx", "\[Wedge]", "dy"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207448913782*^9, 3.836210126830648*^9, 3.8362110298950663`*^9, 
   3.83621189267627*^9, 3.836212080891211*^9, 3.83621218890345*^9, 
   3.836217252876401*^9, 3.836238956534382*^9, 3.8362446686514273`*^9, 
   3.836355561144068*^9, 3.836355862096023*^9, 3.836356125210206*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"48ea6034-bd77-41bf-ada3-6edca9ecec3b"]
}, Open  ]],

Cell["\<\
ExteriorDerivative with empty brackets is just a shortcut to take the \
derivative in the product space of all defined spaces:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.83620745271535*^9, 3.836207520111701*^9}},
 CellID->1200626914,ExpressionUUID->"deb8c15c-457c-4f62-98a3-86ae1c957e62"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dL", "\[Equal]", 
   RowBox[{
    RowBox[{"ExteriorDerivative", "[", 
     RowBox[{
     "\"\<Spatial\>\"", ",", " ", "\"\<Momentum\>\"", ",", " ", 
      "\"\<Time\>\""}], "]"}], "[", "L", "]"}]}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dL", "\[Equal]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExteriorDerivative", "[", "\"\<Spatial\>\"", "]"}], "[", "L", 
     "]"}], "+", 
    RowBox[{
     RowBox[{"ExteriorDerivative", "[", "\"\<Momentum\>\"", "]"}], "[", "L", 
     "]"}], "+", 
    RowBox[{
     RowBox[{"ExteriorDerivative", "[", "\"\<Time\>\"", "]"}], "[", "L", 
     "]"}]}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, {3.8361921566094627`*^9, 
   3.836192156958659*^9}, {3.836192201781852*^9, 3.836192333205892*^9}, {
   3.836192595838347*^9, 3.836192605954053*^9}, {3.8362073968761253`*^9, 
   3.836207409440827*^9}, {3.836207529335801*^9, 3.836207529489655*^9}, {
   3.836207562604879*^9, 3.836207620328455*^9}},
 CellLabel->"In[82]:=",
 CellID->618153103,ExpressionUUID->"ca508920-471f-4228-a1ed-71a6d001a441"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207585210754*^9, 3.8362076225909443`*^9, 3.836210132637411*^9, 
   3.836211038809236*^9, 3.8362121902694407`*^9, 3.836217254389607*^9, 
   3.836238978697679*^9, 3.8362446721657057`*^9, 3.836355588777886*^9, 
   3.83635586680407*^9, 3.8363561287364063`*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"c907044d-1f76-4504-bf74-01d0a5a4c089"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207585210754*^9, 3.8362076225909443`*^9, 3.836210132637411*^9, 
   3.836211038809236*^9, 3.8362121902694407`*^9, 3.836217254389607*^9, 
   3.836238978697679*^9, 3.8362446721657057`*^9, 3.836355588777886*^9, 
   3.83635586680407*^9, 3.8363561315339823`*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"0fb33b3b-1be7-479f-b2e5-bca021a7310e"]
}, Open  ]],

Cell["\<\
Let us now find the evolution equations. We define a general vector field v \
and then demand it to be the null vector of dL, i.e., its contraction with dL \
must be zero. Note that vt below just controls the rate of time (or v \
normalization) and can be set to 1:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.83620745271535*^9, 3.836207520111701*^9}, {3.836207669884253*^9, 
   3.8362077456994343`*^9}, {3.8362077956778173`*^9, 
   3.8362078124701366`*^9}, {3.83620787788202*^9, 3.836207900315724*^9}, {
   3.8362079317627897`*^9, 3.836208006130601*^9}},
 CellID->382087190,ExpressionUUID->"b3167981-3d3b-47cc-b221-84d6966e2e51"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vspatial", "[", "i", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vmomentum", "[", "a", "]"}], "\[Congruent]", 
  RowBox[{"{", 
   RowBox[{"vp1", ",", "vp2", ",", "vp3"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"v", "=", 
  RowBox[{
   RowBox[{"\[Eth]t", "+", 
    RowBox[{
     RowBox[{"vspatial", "[", "i", "]"}], 
     RowBox[{"basis", "[", 
      RowBox[{"-", "i"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"vmomentum", "[", "a", "]"}], 
     RowBox[{"basis", "[", 
      RowBox[{"-", "a"}], "]"}]}]}], "//", 
   "GetArray"}]}], "\[IndentingNewLine]", 
 RowBox[{"(", 
  RowBox[{"EqEvolution", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoefficientArrays", "[", 
       RowBox[{
        RowBox[{"InteriorProduct", "[", 
         RowBox[{"v", ",", "dL"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "dt", ",", "dx", ",", "dy", ",", "dz", ",", "dp1", ",", "dp2", ",", 
          "dp3"}], "}"}]}], "]"}], "//", "Last"}], "//", "Normal"}], "//", 
    "FullSimplify"}]}], ")"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, {3.8361921566094627`*^9, 
   3.836192156958659*^9}, {3.836192201781852*^9, 3.836192333205892*^9}, {
   3.836192595838347*^9, 3.836192605954053*^9}, {3.8362073968761253`*^9, 
   3.836207409440827*^9}, {3.836207529335801*^9, 3.836207529489655*^9}, {
   3.836207562604879*^9, 3.836207620328455*^9}, {3.836208010534128*^9, 
   3.836208127585369*^9}, {3.836208370794755*^9, 3.8362083790098953`*^9}, {
   3.8362084862778263`*^9, 3.836208546896142*^9}, {3.836208586638194*^9, 
   3.836208587941386*^9}, {3.8362087748054543`*^9, 3.836208776704378*^9}, {
   3.836208818045272*^9, 3.8362088205493383`*^9}, {3.836208870954856*^9, 
   3.836208922371462*^9}, {3.836244742148035*^9, 3.836244745496304*^9}, {
   3.836245089596898*^9, 3.836245113356097*^9}, {3.836245685315382*^9, 
   3.836245704413938*^9}},
 CellLabel->"In[84]:=",
 CellID->1984894718,ExpressionUUID->"e47a44f1-448b-49ce-8ded-0a6bffec635b"],

Cell[BoxData[
 RowBox[{"\[Eth]t", "+", 
  RowBox[{"\[Eth]p1", " ", "vp1"}], "+", 
  RowBox[{"\[Eth]p2", " ", "vp2"}], "+", 
  RowBox[{"\[Eth]p3", " ", "vp3"}], "+", 
  RowBox[{"\[Eth]x", " ", "vx"}], "+", 
  RowBox[{"\[Eth]y", " ", "vy"}], "+", 
  RowBox[{"\[Eth]z", " ", "vz"}]}]], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207585210754*^9, 3.8362076225909443`*^9, 3.8362081297826157`*^9, 
   3.836208379993719*^9, 3.836208487029623*^9, 3.8362085192478933`*^9, {
   3.83620888609554*^9, 3.8362089229329453`*^9}, 3.8362101365768423`*^9, 
   3.836211041602317*^9, 3.8362118932747297`*^9, 3.836212080941802*^9, 
   3.83621219160465*^9, 3.836217255932269*^9, 3.83623898148619*^9, 
   3.836244674732226*^9, 3.836244779926511*^9, {3.836245091642395*^9, 
   3.8362451139178133`*^9}, {3.836245688118094*^9, 3.836245704950954*^9}, 
   3.836355593543347*^9, 3.8363558704203444`*^9, 3.836356131564493*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"d6c7be5a-9f32-4fc6-b727-335230efe905"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"p1", " ", "vp1"}], 
      SqrtBox[
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}]]]}], "-", 
    FractionBox[
     RowBox[{"p2", " ", "vp2"}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}]]], "-", 
    FractionBox[
     RowBox[{"p3", " ", "vp3"}], 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}]]], "+", 
    RowBox[{"Ez", " ", "vz"}], "+", 
    FractionBox[
     RowBox[{"Bz", " ", "vp3", " ", "\[HBar]"}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}]}]], "-", 
    FractionBox[
     RowBox[{"Bz", " ", "p3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p1", " ", "vp1"}], "+", 
        RowBox[{"p2", " ", "vp2"}], "+", 
        RowBox[{"p3", " ", "vp3"}]}], ")"}], " ", "\[HBar]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}], "2"]]}], ",", 
   RowBox[{"vp1", "-", 
    RowBox[{"Bz", " ", "vy"}]}], ",", 
   RowBox[{"vp2", "+", 
    RowBox[{"Bz", " ", "vx"}]}], ",", 
   RowBox[{
    RowBox[{"-", "Ez"}], "+", "vp3"}], ",", 
   RowBox[{
    RowBox[{"-", "vx"}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"p3", " ", "vp2"}], "-", 
        RowBox[{"p2", " ", "vp3"}]}], ")"}], " ", "\[HBar]"}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]], "+", 
    RowBox[{"p1", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}]]], "+", 
       FractionBox[
        RowBox[{"Bz", " ", "p3", " ", "\[HBar]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p1", "2"], "+", 
           SuperscriptBox["p2", "2"], "+", 
           SuperscriptBox["p3", "2"]}], ")"}], "2"]]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "vy"}], "+", 
    RowBox[{"p2", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}]]], "+", 
       FractionBox[
        RowBox[{"Bz", " ", "p3", " ", "\[HBar]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["p1", "2"], "+", 
           SuperscriptBox["p2", "2"], "+", 
           SuperscriptBox["p3", "2"]}], ")"}], "2"]]}], ")"}]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"-", "p3"}], " ", "vp1", " ", "\[HBar]"}], "+", 
      RowBox[{"p1", " ", "vp3", " ", "\[HBar]"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}], ",", 
   RowBox[{
    FractionBox["p3", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}]]], "-", "vz", "+", 
    FractionBox[
     RowBox[{"Bz", " ", 
      SuperscriptBox["p3", "2"], " ", "\[HBar]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}], "2"]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Bz", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["p1", "2"], "+", 
           SuperscriptBox["p2", "2"], "+", 
           SuperscriptBox["p3", "2"]}]]}], "-", 
        RowBox[{"p2", " ", "vp1"}], "+", 
        RowBox[{"p1", " ", "vp2"}]}], ")"}], " ", "\[HBar]"}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207585210754*^9, 3.8362076225909443`*^9, 3.8362081297826157`*^9, 
   3.836208379993719*^9, 3.836208487029623*^9, 3.8362085192478933`*^9, {
   3.83620888609554*^9, 3.8362089229329453`*^9}, 3.8362101365768423`*^9, 
   3.836211041602317*^9, 3.8362118932747297`*^9, 3.836212080941802*^9, 
   3.83621219160465*^9, 3.836217255932269*^9, 3.83623898148619*^9, 
   3.836244674732226*^9, 3.836244779926511*^9, {3.836245091642395*^9, 
   3.8362451139178133`*^9}, {3.836245688118094*^9, 3.836245704950954*^9}, 
   3.836355593543347*^9, 3.8363558704203444`*^9, 3.836356145612406*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"c95f1cb7-d0fc-44bc-8969-fde40e760893"]
}, Open  ]],

Cell["\<\
This system of equations indeed has the unique solution for the system \
evolution. The resulting vector reads:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.83620745271535*^9, 3.836207520111701*^9}, {3.836207669884253*^9, 
   3.8362077456994343`*^9}, {3.8362077956778173`*^9, 
   3.8362078124701366`*^9}, {3.83620787788202*^9, 3.836207900315724*^9}, {
   3.8362079317627897`*^9, 3.836208006130601*^9}, {3.8362452263228493`*^9, 
   3.8362452587565928`*^9}, {3.836245539087473*^9, 3.836245542965129*^9}, {
   3.836245593523699*^9, 3.836245608444367*^9}},
 CellID->494369864,ExpressionUUID->"c40e4839-4c2a-4d2b-92d7-97a941228283"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vEvol", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"v", "/.", 
      RowBox[{"First", "@", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"EqEvolution", "\[Equal]", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "vx", ",", "vy", ",", "vz", ",", "vp1", ",", "vp2", ",", "vp3"}], 
          "}"}]}], "]"}]}]}], "//", "Normal"}], "//", "FullSimplify"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, {3.8361921566094627`*^9, 
   3.836192156958659*^9}, {3.836192201781852*^9, 3.836192333205892*^9}, {
   3.836192595838347*^9, 3.836192605954053*^9}, {3.8362073968761253`*^9, 
   3.836207409440827*^9}, {3.836207529335801*^9, 3.836207529489655*^9}, {
   3.836207562604879*^9, 3.836207620328455*^9}, {3.836208010534128*^9, 
   3.836208127585369*^9}, {3.836208370794755*^9, 3.8362083790098953`*^9}, {
   3.8362084862778263`*^9, 3.836208546896142*^9}, {3.836208586638194*^9, 
   3.836208587941386*^9}, {3.8362087748054543`*^9, 3.836208776704378*^9}, {
   3.836208818045272*^9, 3.8362088205493383`*^9}, {3.836208870954856*^9, 
   3.836208922371462*^9}, {3.836211338937461*^9, 3.836211433390827*^9}, {
   3.83621196605807*^9, 3.8362119951109123`*^9}, 3.8362122114454823`*^9, {
   3.836245611389703*^9, 3.836245622828175*^9}, {3.836245762801559*^9, 
   3.836245773452508*^9}, {3.836245804579121*^9, 3.836245829233027*^9}, {
   3.8362463893122253`*^9, 3.836246395558074*^9}},
 CellLabel->"In[88]:=",
 CellID->976938184,ExpressionUUID->"2abf0fa9-19bb-4be0-859d-476fae35d3af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["Bz", "2"], " ", "p3", " ", "\[HBar]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "\[Eth]p2"}], " ", "p1"}], "+", 
          RowBox[{"\[Eth]p1", " ", "p2"}]}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}]]}], "+", 
       RowBox[{"\[Eth]z", " ", "\[HBar]"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["p1", "2"], "+", 
       SuperscriptBox["p2", "2"], "+", 
       SuperscriptBox["p3", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "\[Eth]x", " ", "p1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", "\[Eth]y", " ", "p2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Eth]z", " ", "p3"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Eth]t", "+", 
             RowBox[{"\[Eth]p3", " ", "Ez"}]}], ")"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["p1", "2"], "+", 
             SuperscriptBox["p2", "2"], "+", 
             SuperscriptBox["p3", "2"]}]]}]}], ")"}]}], "+", 
       RowBox[{"\[Eth]y", " ", "Ez", " ", "p1", " ", "\[HBar]"}], "-", 
       RowBox[{"\[Eth]x", " ", "Ez", " ", "p2", " ", "\[HBar]"}]}], ")"}]}], 
    "+", 
    RowBox[{"2", " ", "Bz", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"p3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Eth]x", " ", "p1"}], "+", 
             RowBox[{"\[Eth]y", " ", "p2"}], "+", 
             RowBox[{"\[Eth]z", " ", "p3"}]}], ")"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["p1", "2"], "+", 
             SuperscriptBox["p2", "2"], "+", 
             SuperscriptBox["p3", "2"]}]]}], "+", 
          RowBox[{"\[Eth]t", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p1", "2"], "+", 
             SuperscriptBox["p2", "2"], "+", 
             SuperscriptBox["p3", "2"]}], ")"}]}], "+", 
          RowBox[{"\[Eth]p3", " ", "Ez", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p1", "2"], "+", 
             SuperscriptBox["p2", "2"], "+", 
             SuperscriptBox["p3", "2"]}], ")"}]}]}], ")"}], " ", "\[HBar]"}], 
       "+", 
       RowBox[{"\[Eth]p1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "p2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p1", "2"], "+", 
             SuperscriptBox["p2", "2"], "+", 
             SuperscriptBox["p3", "2"]}], ")"}]}], "+", 
          RowBox[{"Ez", " ", "p1", " ", "\[HBar]"}]}], ")"}]}], "+", 
       RowBox[{"\[Eth]p2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["p3", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "p1", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p1", "2"], "+", 
             SuperscriptBox["p2", "2"], "+", 
             SuperscriptBox["p3", "2"]}], ")"}]}], "+", 
          RowBox[{"Ez", " ", "p2", " ", "\[HBar]"}]}], ")"}]}]}], ")"}]}]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["p1", "2"], "+", 
      SuperscriptBox["p2", "2"], "+", 
      SuperscriptBox["p3", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["p1", "2"], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["p2", "2"], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["p3", "2"]}]]}], "+", 
      RowBox[{"p3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "p3", " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["p1", "2"], "+", 
            SuperscriptBox["p2", "2"], "+", 
            SuperscriptBox["p3", "2"]}]]}], "+", 
         RowBox[{"Bz", " ", "\[HBar]"}]}], ")"}]}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207585210754*^9, 3.8362076225909443`*^9, 3.8362081297826157`*^9, 
   3.836208379993719*^9, 3.836208487029623*^9, 3.8362085192478933`*^9, {
   3.83620888609554*^9, 3.8362089229329453`*^9}, 3.8362101365768423`*^9, 
   3.836211041602317*^9, {3.836211397838393*^9, 3.8362114342033253`*^9}, {
   3.836211974144225*^9, 3.836211996229904*^9}, 3.836212198483005*^9, {
   3.83624561370973*^9, 3.836245630731185*^9}, {3.8362457657656937`*^9, 
   3.836245774010233*^9}, {3.8362458203022127`*^9, 3.836245840741877*^9}, 
   3.836246407205742*^9, 3.8363555941514263`*^9, 3.836355896899506*^9, 
   3.8363561530179253`*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"9b360bf3-e20c-42f5-a7c2-fe3f0daf10eb"]
}, Open  ]],

Cell["\<\
Due to complexity of the evolution it is hard to actually find the canonical \
coordinates of the phase space and project dL onto them. It is still easy, \
however, to find the phase space volume, as it can be found from the highest \
non-trivial power of the symplectic form:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.83620745271535*^9, 3.836207520111701*^9}, {3.836207669884253*^9, 
   3.8362077456994343`*^9}, {3.8362077956778173`*^9, 
   3.8362078124701366`*^9}, {3.83620787788202*^9, 3.836207900315724*^9}, {
   3.8362079317627897`*^9, 3.836208006130601*^9}, {3.8362452263228493`*^9, 
   3.8362452587565928`*^9}, {3.836245539087473*^9, 3.836245542965129*^9}, {
   3.836245593523699*^9, 3.836245608444367*^9}, {3.836246484664616*^9, 
   3.8362465072807703`*^9}, 3.836246544289897*^9, {3.836246581742426*^9, 
   3.836246641026305*^9}, {3.83624688619888*^9, 3.836246946357458*^9}},
 CellID->470199887,ExpressionUUID->"f31b6a5d-a260-4a8c-b9ec-b22ebbe4f3a8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vol", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"3", "!"}]], 
     RowBox[{"dL", "\[Wedge]", "dL", "\[Wedge]", "dL", "\[Wedge]", "dt"}]}], "//",
     "FullSimplify"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, {3.8361921566094627`*^9, 
   3.836192156958659*^9}, {3.836192201781852*^9, 3.836192333205892*^9}, {
   3.836192595838347*^9, 3.836192605954053*^9}, {3.8362073968761253`*^9, 
   3.836207409440827*^9}, {3.836207529335801*^9, 3.836207529489655*^9}, {
   3.836207562604879*^9, 3.836207620328455*^9}, {3.836208010534128*^9, 
   3.836208127585369*^9}, {3.836208370794755*^9, 3.8362083790098953`*^9}, {
   3.8362084862778263`*^9, 3.836208546896142*^9}, {3.836208586638194*^9, 
   3.836208587941386*^9}, {3.8362087748054543`*^9, 3.836208776704378*^9}, {
   3.836208818045272*^9, 3.8362088205493383`*^9}, {3.836208870954856*^9, 
   3.836208922371462*^9}, {3.836211338937461*^9, 3.836211433390827*^9}, {
   3.83621196605807*^9, 3.8362119951109123`*^9}, 3.8362122114454823`*^9, {
   3.836245611389703*^9, 3.836245622828175*^9}, {3.836245762801559*^9, 
   3.836245773452508*^9}, {3.836245804579121*^9, 3.836245829233027*^9}, {
   3.8362463893122253`*^9, 3.836246395558074*^9}, {3.836246972590659*^9, 
   3.836246977510977*^9}, {3.836247117046496*^9, 3.836247119092203*^9}, {
   3.836247278673019*^9, 3.8362472794295187`*^9}},
 CellLabel->"In[89]:=",
 CellID->186017677,ExpressionUUID->"6719ee1e-8d5b-4de7-a869-1c825ccfe92c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    FractionBox[
     RowBox[{"Bz", " ", "p3", " ", "\[HBar]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["p1", "2"], "+", 
        SuperscriptBox["p2", "2"], "+", 
        SuperscriptBox["p3", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]]}], ")"}], " ", 
  RowBox[{
  "dp1", "\[Wedge]", "dp2", "\[Wedge]", "dp3", "\[Wedge]", "dt", "\[Wedge]", 
   "dx", "\[Wedge]", "dy", "\[Wedge]", "dz"}]}]], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207585210754*^9, 3.8362076225909443`*^9, 3.8362081297826157`*^9, 
   3.836208379993719*^9, 3.836208487029623*^9, 3.8362085192478933`*^9, {
   3.83620888609554*^9, 3.8362089229329453`*^9}, 3.8362101365768423`*^9, 
   3.836211041602317*^9, {3.836211397838393*^9, 3.8362114342033253`*^9}, {
   3.836211974144225*^9, 3.836211996229904*^9}, 3.836212198483005*^9, {
   3.83624561370973*^9, 3.836245630731185*^9}, {3.8362457657656937`*^9, 
   3.836245774010233*^9}, {3.8362458203022127`*^9, 3.836245840741877*^9}, 
   3.836246407205742*^9, 3.836247236752405*^9, 3.8362474026512423`*^9, 
   3.836355594196126*^9, 3.836356039474115*^9, 3.836356278262989*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"c7ed7536-3058-4fa4-8daa-9f2320e81f4d"]
}, Open  ]],

Cell["\<\
Let us finally check that the Liouville theorem in this theory still holds \
and the volume form stays invariant during the evolution. In other words, we \
show that its Lie derivative in the direction of evolution is zero:\
\>", "ExampleText",
 CellChangeTimes->{{3.835948720407342*^9, 3.835948730794841*^9}, {
   3.836133986268313*^9, 3.8361340450234547`*^9}, {3.8361887375344353`*^9, 
   3.8361887863937073`*^9}, {3.836188886571027*^9, 3.836188922623629*^9}, {
   3.836189009246986*^9, 3.836189033627825*^9}, {3.836189065395461*^9, 
   3.836189086815627*^9}, {3.836189117786338*^9, 3.836189172229217*^9}, {
   3.8361894750099487`*^9, 3.83618953303636*^9}, {3.836189611309401*^9, 
   3.836189627836358*^9}, {3.836189814692956*^9, 3.8361898658213*^9}, {
   3.836189972753745*^9, 3.836189973807962*^9}, {3.836190895107633*^9, 
   3.836190947744082*^9}, {3.8361917262842703`*^9, 3.836191727859453*^9}, {
   3.8361917747669363`*^9, 3.836191853482462*^9}, {3.8361920815775423`*^9, 
   3.836192151087016*^9}, {3.8361926318048897`*^9, 3.836192686184534*^9}, {
   3.836192748439328*^9, 3.8361927627168913`*^9}, {3.836192796202505*^9, 
   3.836192819408546*^9}, {3.836192872318344*^9, 3.8361928785530157`*^9}, {
   3.836193554716547*^9, 3.836193639167992*^9}, {3.836194331387363*^9, 
   3.836194362391776*^9}, 3.836206773841453*^9, {3.8362068220163794`*^9, 
   3.836206826947382*^9}, {3.8362068597714033`*^9, 3.836207073752123*^9}, {
   3.836207135415921*^9, 3.836207162947584*^9}, {3.8362071964257507`*^9, 
   3.836207219290814*^9}, {3.836207289862895*^9, 3.836207391288393*^9}, {
   3.83620745271535*^9, 3.836207520111701*^9}, {3.836207669884253*^9, 
   3.8362077456994343`*^9}, {3.8362077956778173`*^9, 
   3.8362078124701366`*^9}, {3.83620787788202*^9, 3.836207900315724*^9}, {
   3.8362079317627897`*^9, 3.836208006130601*^9}, {3.8362452263228493`*^9, 
   3.8362452587565928`*^9}, {3.836245539087473*^9, 3.836245542965129*^9}, {
   3.836245593523699*^9, 3.836245608444367*^9}, {3.836246484664616*^9, 
   3.8362465072807703`*^9}, 3.836246544289897*^9, {3.836246581742426*^9, 
   3.836246641026305*^9}, {3.83624688619888*^9, 3.836246946357458*^9}, {
   3.8362472919786587`*^9, 3.836247406335087*^9}},
 CellID->1160909760,ExpressionUUID->"d7be63cc-10ee-4d07-bafb-c2fabee0a495"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"LieDerivative", "[", 
   RowBox[{"vEvol", ",", "vol"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, {3.836188962329571*^9, 3.8361890198515387`*^9}, {
   3.836189181642479*^9, 3.836189221976232*^9}, {3.8361892873842907`*^9, 
   3.836189310830908*^9}, {3.8361909576173277`*^9, 3.8361910097601767`*^9}, {
   3.83619186105926*^9, 3.836191939863874*^9}, {3.8361921566094627`*^9, 
   3.836192156958659*^9}, {3.836192201781852*^9, 3.836192333205892*^9}, {
   3.836192595838347*^9, 3.836192605954053*^9}, {3.8362073968761253`*^9, 
   3.836207409440827*^9}, {3.836207529335801*^9, 3.836207529489655*^9}, {
   3.836207562604879*^9, 3.836207620328455*^9}, {3.836208010534128*^9, 
   3.836208127585369*^9}, {3.836208370794755*^9, 3.8362083790098953`*^9}, {
   3.8362084862778263`*^9, 3.836208546896142*^9}, {3.836208586638194*^9, 
   3.836208587941386*^9}, {3.8362087748054543`*^9, 3.836208776704378*^9}, {
   3.836208818045272*^9, 3.8362088205493383`*^9}, {3.836208870954856*^9, 
   3.836208922371462*^9}, {3.836211338937461*^9, 3.836211433390827*^9}, {
   3.83621196605807*^9, 3.8362119951109123`*^9}, 3.8362122114454823`*^9, {
   3.836245611389703*^9, 3.836245622828175*^9}, {3.836245762801559*^9, 
   3.836245773452508*^9}, {3.836245804579121*^9, 3.836245829233027*^9}, {
   3.8362463893122253`*^9, 3.836246395558074*^9}, {3.836246972590659*^9, 
   3.836246977510977*^9}, {3.836247117046496*^9, 3.836247119092203*^9}, {
   3.836247410822914*^9, 3.836247419556101*^9}, {3.836247582215581*^9, 
   3.8362476188236513`*^9}},
 CellLabel->"In[90]:=",
 CellID->1884373775,ExpressionUUID->"e7cdae42-3768-4910-8d51-4e699a8cab65"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.836207402724695*^9, 3.836207413214406*^9}, 
   3.836207585210754*^9, 3.8362076225909443`*^9, 3.8362081297826157`*^9, 
   3.836208379993719*^9, 3.836208487029623*^9, 3.8362085192478933`*^9, {
   3.83620888609554*^9, 3.8362089229329453`*^9}, 3.8362101365768423`*^9, 
   3.836211041602317*^9, {3.836211397838393*^9, 3.8362114342033253`*^9}, {
   3.836211974144225*^9, 3.836211996229904*^9}, 3.836212198483005*^9, {
   3.83624561370973*^9, 3.836245630731185*^9}, {3.8362457657656937`*^9, 
   3.836245774010233*^9}, {3.8362458203022127`*^9, 3.836245840741877*^9}, 
   3.836246407205742*^9, 3.836247236752405*^9, 3.83624756076299*^9, 
   3.8362475952950087`*^9, 3.836247765896193*^9, 3.836355595085329*^9, 
   3.836356428700416*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"34b9c8b6-2ddf-4930-a73e-3829d8438451"]
}, Open  ]],

Cell["\<\
Lastly, after all the calculations we tidy up after ourselves:\
\>", "ExampleText",
 CellChangeTimes->CompressedData["
1:eJwdyU0ogwEAxvH5mEQIW9iHj1hKEUtCSZO1ZTfT2FjTZFw0tknMItRe0ZaN
ZMVBkq01lyVtB0nJhWGylt18HPTuYDRtF97nPTz9evrXaPX945kMBoNLDSZy
C54t26RIoVdGIEc4Z7ujjA/w7XBrbNIFK8m9I5il2TyBGYTAD23GkShcmYnE
6M/8eYNDr+x3WqmYhBJpODtEuWboKoS8VLQYGtx9HJje1VVD/0FZC+R2bHRC
h1C6Siu7scLGHUL+QDn1FVfAwVq2AS6ONhuhtI5YgPIcvxkunzu9UOcInMLD
S+X0I2Uy9GSCZPBwH5arfEcwZfp1w96LUi9M3BNndFebg7Dbw7iCPczbayir
2isJU7pm4xWwzUfUw3TAQ+v7aNDA43bWBNS+WOwRSoEzzwlb/6yKb8r1fIkK
Jkh1kXiHFAmHm1jwcz7Jg7ElLR/+A4DU8KI=
  "],
 CellID->250862890,ExpressionUUID->"95fa6fe0-e3f9-453f-847a-07d64231b7ad"],

Cell[BoxData[{
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Spatial\>\"", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Momentum\>\"", ",", "0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"DefineSpace", "[", 
  RowBox[{"\"\<Time\>\"", ",", "0"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.835948733032742*^9, 3.836114501804606*^9, {3.836114987702142*^9, 
   3.836115028951778*^9}, {3.8361150920111027`*^9, 3.836115137425633*^9}, {
   3.8361152082643547`*^9, 3.836115236511332*^9}, {3.836115417068651*^9, 
   3.8361154370626507`*^9}, {3.836115960427393*^9, 3.8361159782436943`*^9}, 
   3.836116034403319*^9, {3.8361161039022207`*^9, 3.8361161163380404`*^9}, {
   3.836117269695117*^9, 3.83611727327763*^9}, {3.836117490355998*^9, 
   3.836117491045287*^9}, {3.836117692013042*^9, 3.836117695454706*^9}, {
   3.836117780004839*^9, 3.836117790514974*^9}, {3.836118075471648*^9, 
   3.836118079260954*^9}, {3.836118335155142*^9, 3.8361183441563387`*^9}, {
   3.8361191559241877`*^9, 3.836119186837718*^9}, 3.836119520916081*^9, {
   3.836119603684318*^9, 3.83611960382892*^9}, 3.8361224172709713`*^9, {
   3.836122469356258*^9, 3.836122515694672*^9}, {3.836122689501521*^9, 
   3.836122805175*^9}, {3.836123018017068*^9, 3.8361230226582413`*^9}, {
   3.836123164359923*^9, 3.8361231703468933`*^9}, {3.8361233494350147`*^9, 
   3.836123355044324*^9}, {3.83612338939194*^9, 3.836123511098012*^9}, {
   3.83612362545242*^9, 3.8361236666686773`*^9}, {3.8361325303194437`*^9, 
   3.836132554969844*^9}, {3.836132591439294*^9, 3.836132619708838*^9}, {
   3.83613269856485*^9, 3.836132790112094*^9}, {3.836132851687725*^9, 
   3.8361328736238527`*^9}, {3.836132913256542*^9, 3.836132921793108*^9}, {
   3.836132980468462*^9, 3.836133090353097*^9}, {3.836133164717464*^9, 
   3.836133169689107*^9}, {3.836133217694584*^9, 3.836133217879562*^9}, {
   3.836133274195589*^9, 3.8361333330204067`*^9}, {3.836133366127644*^9, 
   3.8361333892159233`*^9}, 3.836189407346874*^9, {3.8361901911798077`*^9, 
   3.836190193502598*^9}, {3.836190691258875*^9, 3.836190693209181*^9}, 
   3.8363567271971292`*^9, {3.83635677602579*^9, 3.836356784701152*^9}},
 CellLabel->"In[91]:=",
 CellID->642415863,ExpressionUUID->"c5dcabdc-925c-4356-875a-30c7c780211a"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{955, 1062},
WindowMargins->{{0, Automatic}, {-2, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Dark.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 164, 3, 99, "Title",ExpressionUUID->"cd0d1fc8-7cf8-49f1-9b9b-2f0e2deeff83"],
Cell[747, 27, 156, 2, 34, "Input",ExpressionUUID->"daba3984-9e80-4d1d-a967-4e019fe3d35d"],
Cell[CellGroupData[{
Cell[928, 33, 167, 3, 70, "Chapter",ExpressionUUID->"38c80fbf-f787-4a0b-880e-b14a594d1836"],
Cell[1098, 38, 502, 9, 61, "ExampleText",ExpressionUUID->"eaee3e8a-c866-4ae1-a615-321dfac92280",
 CellID->343544594],
Cell[1603, 49, 844, 24, 55, "Input",ExpressionUUID->"1ca643c8-6aa1-4d44-82cd-728f79721962",
 CellID->189277084],
Cell[2450, 75, 410, 7, 25, "ExampleText",ExpressionUUID->"29e0abc5-42bf-407a-9417-be8cd42b08ab",
 CellID->1459807809],
Cell[2863, 84, 644, 16, 55, "Input",ExpressionUUID->"608dc93d-dfc0-48b7-8ba8-41b5f8132ae5",
 CellID->272556410],
Cell[3510, 102, 307, 4, 25, "ExampleText",ExpressionUUID->"842082ba-6947-4153-a90d-e4ec1819acbd",
 CellID->565758205],
Cell[3820, 108, 659, 16, 31, "Input",ExpressionUUID->"88275b09-39e4-4d8c-8f8d-cbcccd78ddc4",
 CellID->1583466693],
Cell[4482, 126, 613, 10, 61, "ExampleText",ExpressionUUID->"ce827879-144f-43fe-ab6c-6a99a122f0a1",
 CellID->247280041],
Cell[CellGroupData[{
Cell[5120, 140, 370, 9, 31, "Input",ExpressionUUID->"4054f000-e24f-4320-b09c-0e1640974472",
 CellID->662083154],
Cell[5493, 151, 515, 9, 35, "Output",ExpressionUUID->"9a1e200e-c214-4b67-8fa2-e5b8e7067fd8"]
}, Open  ]],
Cell[6023, 163, 462, 10, 61, "ExampleText",ExpressionUUID->"a1375a16-6401-44d2-acf8-a5ae58a0dffb",
 CellID->146943780],
Cell[CellGroupData[{
Cell[6510, 177, 871, 25, 55, "Input",ExpressionUUID->"0d8c44d8-5e1f-40f9-a1f2-c334a09beea5",
 CellID->158129306],
Cell[7384, 204, 8045, 236, 117, "Output",ExpressionUUID->"e05ffb89-adf1-4fd5-b205-10ca2318f4c4"]
}, Open  ]],
Cell[15444, 443, 492, 8, 43, "ExampleText",ExpressionUUID->"bb4bef05-6c6a-4116-8a9e-f82d82d63fec",
 CellID->573994711],
Cell[CellGroupData[{
Cell[15961, 455, 963, 32, 55, "Input",ExpressionUUID->"fd11b4d3-ff91-452a-80db-389233ca2a41"],
Cell[16927, 489, 781, 17, 35, "Output",ExpressionUUID->"7af6955e-519e-4f8c-a885-4a80e57bfcec"],
Cell[17711, 508, 783, 17, 35, "Output",ExpressionUUID->"e235c22a-c265-423b-80d5-677bccaf3063"]
}, Open  ]],
Cell[18509, 528, 566, 9, 43, "ExampleText",ExpressionUUID->"0694a10f-2082-42c6-ad68-4c0a11f9f1ac",
 CellID->204766713],
Cell[CellGroupData[{
Cell[19100, 541, 737, 23, 71, "Input",ExpressionUUID->"e58be613-3aeb-4dd4-8918-421e4dd56730"],
Cell[19840, 566, 2839, 82, 113, "Output",ExpressionUUID->"f3b2e9d8-9edb-486b-9bdc-04431445a676"],
Cell[22682, 650, 2795, 81, 113, "Output",ExpressionUUID->"5b63015c-03d1-4c68-b627-fdc501437b9f"]
}, Open  ]],
Cell[25492, 734, 920, 16, 79, "ExampleText",ExpressionUUID->"94e708a0-e169-438f-8d25-65d3c10bdc0d",
 CellID->1231890411],
Cell[26415, 752, 1867, 47, 86, "Input",ExpressionUUID->"1b15b5d6-e06c-4d89-ab47-b46dac357e27"],
Cell[28285, 801, 852, 13, 25, "ExampleText",ExpressionUUID->"2ad60b8e-f285-4b5a-8e56-e55a983cfdd3",
 CellID->163416474],
Cell[CellGroupData[{
Cell[29162, 818, 1604, 43, 55, "Input",ExpressionUUID->"990268cb-c8e1-47ed-a8ea-e03499759924"],
Cell[30769, 863, 4028, 118, 102, "Output",ExpressionUUID->"20b96c8b-0163-46a7-beca-b3d04b6b2e4b"]
}, Open  ]],
Cell[34812, 984, 733, 9, 25, "ExampleText",ExpressionUUID->"7f52ac1b-9f93-4175-a83a-b8152be4f14f",
 CellID->829826839],
Cell[CellGroupData[{
Cell[35570, 997, 684, 14, 31, "Input",ExpressionUUID->"4b1cf972-5d90-44c6-9cec-e7814a1de55f"],
Cell[36257, 1013, 4221, 121, 102, "Output",ExpressionUUID->"ded1ed3f-6e53-4bc4-987b-632251d11c0f"]
}, Open  ]],
Cell[40493, 1137, 771, 14, 79, "ExampleText",ExpressionUUID->"8d0c4aa5-8f54-49f0-94e5-8528127615b5",
 CellID->603563055],
Cell[CellGroupData[{
Cell[41289, 1155, 343, 8, 31, "Input",ExpressionUUID->"b6ec64ad-c52f-4249-82eb-40396219b845"],
Cell[41635, 1165, 920, 20, 35, "Output",ExpressionUUID->"e83c0923-f492-40ae-a3f0-0e73486a7f03"]
}, Open  ]],
Cell[42570, 1188, 843, 12, 43, "ExampleText",ExpressionUUID->"f508cf7d-cc68-4ceb-80e9-266771d53511",
 CellID->1839560963],
Cell[CellGroupData[{
Cell[43438, 1204, 819, 22, 71, "Input",ExpressionUUID->"29838a3f-e016-436a-ac58-254613eafbfc"],
Cell[44260, 1228, 4287, 129, 175, "Output",ExpressionUUID->"3f80e353-7342-4611-adab-6d8d2f0bc627"],
Cell[48550, 1359, 532, 7, 35, "Output",ExpressionUUID->"f7d44a40-28d8-4cb0-ae3c-7b88def6afb3"]
}, Open  ]],
Cell[49097, 1369, 891, 12, 25, "ExampleText",ExpressionUUID->"04b70e18-32a6-4807-b4e1-e0a4d4f6c6c8",
 CellID->756486833],
Cell[CellGroupData[{
Cell[50013, 1385, 284, 6, 31, "Input",ExpressionUUID->"49abdc64-812e-4bb3-9fd1-5dc35c1ffca9"],
Cell[50300, 1393, 462, 6, 35, "Output",ExpressionUUID->"0a85eefe-a53c-41c4-802b-f4bd521f3207"]
}, Open  ]],
Cell[50777, 1402, 1116, 16, 43, "ExampleText",ExpressionUUID->"28930725-1e20-48a4-96fc-220c6aef6d61",
 CellID->275950504],
Cell[CellGroupData[{
Cell[51918, 1422, 1972, 47, 180, "Input",ExpressionUUID->"53c3696e-7875-475b-bbde-21ecf293b211"],
Cell[53893, 1471, 7617, 223, 229, "Output",ExpressionUUID->"059426fc-46b3-479e-ba80-fcf635e120f7"]
}, Open  ]],
Cell[61525, 1697, 1319, 21, 61, "ExampleText",ExpressionUUID->"aee8228d-770f-4d4e-b32a-72629c424350",
 CellID->510016645],
Cell[62847, 1720, 296, 5, 31, "Input",ExpressionUUID->"f3ab04e9-2e1b-4e08-ab50-30712567d45c"],
Cell[63146, 1727, 1498, 21, 61, "ExampleText",ExpressionUUID->"5ba16f43-80bd-43da-98df-6638f0b6fb7f",
 CellID->676108050],
Cell[64647, 1750, 1461, 43, 124, "Input",ExpressionUUID->"77362800-c451-48f5-87bb-9ec6764ed7db"],
Cell[66111, 1795, 1237, 16, 25, "ExampleText",ExpressionUUID->"1954ecc9-aae5-40d7-9e03-e738cb0784b2",
 CellID->157352642],
Cell[CellGroupData[{
Cell[67373, 1815, 392, 10, 31, "Input",ExpressionUUID->"bc5bfd70-e6cc-4f3c-8da6-8b273f33c0d8"],
Cell[67768, 1827, 1072, 28, 101, "Output",ExpressionUUID->"3f789ef4-84f9-4a83-9959-f7dfed02ca26"]
}, Open  ]],
Cell[68855, 1858, 1375, 20, 25, "ExampleText",ExpressionUUID->"6fbbe824-a5a3-4a2f-ada8-77007a73ea7d",
 CellID->1846150399],
Cell[70233, 1880, 368, 7, 31, "Input",ExpressionUUID->"97f6b52e-c5ec-44a0-b3d4-06fa52f1106b"],
Cell[70604, 1889, 1512, 21, 25, "ExampleText",ExpressionUUID->"11ebc0bf-7176-4ea2-982e-edd52122cb88",
 CellID->121348350],
Cell[CellGroupData[{
Cell[72141, 1914, 1116, 29, 95, "Input",ExpressionUUID->"478b9e5a-a3e7-4ed0-9b4f-9c77e2ec5f0e"],
Cell[73260, 1945, 1763, 50, 143, "Output",ExpressionUUID->"335f8c25-45b5-41e5-b86f-b4518c76c058"],
Cell[75026, 1997, 1736, 49, 143, "Output",ExpressionUUID->"a8a24132-0f77-448c-8566-12637a41f225"]
}, Open  ]],
Cell[76777, 2049, 1531, 22, 43, "ExampleText",ExpressionUUID->"54733539-090b-43ac-9030-21a404abbb85",
 CellID->919012536],
Cell[78311, 2073, 556, 9, 55, "Input",ExpressionUUID->"1e2e3525-8219-4c7b-964d-19f1ca16ad2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78904, 2087, 288, 8, 119, "Chapter",ExpressionUUID->"52a6ec49-47aa-4559-a887-2d317fb95d3b"],
Cell[79195, 2097, 658, 12, 79, "ExampleText",ExpressionUUID->"d41ab275-fe74-47b8-9b5b-c010ee87f1ab",
 CellID->152417909],
Cell[79856, 2111, 1467, 38, 101, "Input",ExpressionUUID->"570a4092-9a3c-4067-959d-a54a011f6073",
 CellID->345325393],
Cell[81326, 2151, 592, 9, 25, "ExampleText",ExpressionUUID->"0d46bc73-92c7-4fa2-823e-9a73df5958fe",
 CellID->576975665],
Cell[81921, 2162, 1386, 37, 124, "Input",ExpressionUUID->"1218a30b-8f83-4e3e-9d9d-4476a383e5a2",
 CellID->1520145477],
Cell[83310, 2201, 618, 10, 25, "ExampleText",ExpressionUUID->"3fe13347-507f-4e0d-a154-daaf471ac994",
 CellID->1973446229],
Cell[CellGroupData[{
Cell[83953, 2215, 2455, 75, 169, "Input",ExpressionUUID->"1b1ca40e-7dbd-44a7-866d-243ffa71e0c1",
 CellID->323686400],
Cell[86411, 2292, 1100, 29, 101, "Output",ExpressionUUID->"a76b8baf-0150-4438-9ca3-dca3201dbaa9"]
}, Open  ]],
Cell[87526, 2324, 1096, 16, 97, "ExampleText",ExpressionUUID->"136a0ccc-02a3-4395-a9e2-f71665a8d91c",
 CellID->1660613409],
Cell[CellGroupData[{
Cell[88647, 2344, 921, 24, 55, "Input",ExpressionUUID->"44643aaa-3fff-45b2-80a1-e5df0bbb8f38",
 CellID->136406356],
Cell[89571, 2370, 1590, 41, 101, "Output",ExpressionUUID->"239ac88e-303b-41ce-b1ed-7b713072e6f4"]
}, Open  ]],
Cell[91176, 2414, 905, 14, 25, "ExampleText",ExpressionUUID->"41273dd9-3689-4127-8272-d02cdeea9562",
 CellID->2087189712],
Cell[CellGroupData[{
Cell[92106, 2432, 471, 11, 31, "Input",ExpressionUUID->"ff7621e5-616c-4ad9-877d-8b0000e7585d",
 CellID->1977322344],
Cell[92580, 2445, 1692, 45, 88, "Output",ExpressionUUID->"8379150b-ef67-4094-acbc-f190f7fb3ef7"]
}, Open  ]],
Cell[94287, 2493, 1027, 16, 43, "ExampleText",ExpressionUUID->"55619e2a-379f-4570-8173-6cc964862e28",
 CellID->1740822085],
Cell[CellGroupData[{
Cell[95339, 2513, 1574, 37, 113, "Input",ExpressionUUID->"79fc6dd9-d3f1-45e9-bff7-d497ea10c598",
 CellID->1702545356],
Cell[96916, 2552, 2204, 53, 64, "Output",ExpressionUUID->"d220b1c4-ba65-4469-8762-d0dee645016f"]
}, Open  ]],
Cell[99135, 2608, 956, 15, 25, "ExampleText",ExpressionUUID->"9ab5d662-d400-494a-9e77-f6bf76a6a46d",
 CellID->1638289005],
Cell[CellGroupData[{
Cell[100116, 2627, 1126, 20, 31, "Input",ExpressionUUID->"3a58129a-c7f9-4c3e-9122-4f146a62c65c",
 CellID->884991326],
Cell[101245, 2649, 1520, 28, 50, "Output",ExpressionUUID->"6ff752fd-6257-4e53-807e-2d7bd5b1c2f7"]
}, Open  ]],
Cell[102780, 2680, 1156, 18, 43, "ExampleText",ExpressionUUID->"66e679c3-2ad4-4cca-9ff9-2e581ef10ced",
 CellID->1007373254],
Cell[CellGroupData[{
Cell[103961, 2702, 1709, 48, 139, "Input",ExpressionUUID->"cc84a027-7de8-4ca6-8c26-de2b1e5237a9"],
Cell[105673, 2752, 767, 12, 35, "Output",ExpressionUUID->"17dddcee-28f9-478d-92be-9b1e474be46c"],
Cell[106443, 2766, 778, 12, 35, "Output",ExpressionUUID->"2e19edb3-3e14-47e1-b3b7-6d3086c5cc13"]
}, Open  ]],
Cell[107236, 2781, 734, 16, 79, "ExampleText",ExpressionUUID->"492c78ed-014a-4722-a20f-f3c51b57adf7",
 CellID->1776829056],
Cell[CellGroupData[{
Cell[107995, 2801, 1047, 24, 55, "Input",ExpressionUUID->"940df120-27da-4d5b-b054-46ab1a6c1e95"],
Cell[109045, 2827, 1008, 29, 65, "Output",ExpressionUUID->"d28a2330-fe28-46eb-a51d-12e6db19b2ac"]
}, Open  ]],
Cell[110068, 2859, 536, 10, 25, "ExampleText",ExpressionUUID->"ab1ae230-975e-4dc5-94a8-6524960961e1",
 CellID->531348251],
Cell[CellGroupData[{
Cell[110629, 2873, 717, 13, 31, "Input",ExpressionUUID->"d2af56e7-8fc3-41cd-a27e-f83bbadea4be"],
Cell[111349, 2888, 814, 22, 50, "Output",ExpressionUUID->"27575b88-ab18-4dc1-89a4-2bf5a15b06e4"]
}, Open  ]],
Cell[112178, 2913, 611, 12, 25, "ExampleText",ExpressionUUID->"653c4bd0-7e34-48bd-978d-fb44a18fbc74",
 CellID->503673192],
Cell[CellGroupData[{
Cell[112814, 2929, 1270, 30, 67, "Input",ExpressionUUID->"ee6d4f7d-7177-4ff0-b73c-06e859e2ec0b"],
Cell[114087, 2961, 804, 21, 67, "Output",ExpressionUUID->"048f2823-bcae-4f3b-96de-9d3be69f40c8"]
}, Open  ]],
Cell[114906, 2985, 709, 14, 25, "ExampleText",ExpressionUUID->"a3ca1b08-800c-47a8-8c09-c8bc75b51247",
 CellID->739798405],
Cell[CellGroupData[{
Cell[115640, 3003, 1250, 28, 55, "Input",ExpressionUUID->"2f0df5ad-7c07-4b24-8ffe-51601f82cf2f"],
Cell[116893, 3033, 1352, 39, 81, "Output",ExpressionUUID->"01583bfd-e51d-497c-b9fc-343416080850"],
Cell[118248, 3074, 1322, 36, 60, "Output",ExpressionUUID->"ad895a62-9a98-408b-b231-c8504d792449"]
}, Open  ]],
Cell[119585, 3113, 721, 16, 79, "ExampleText",ExpressionUUID->"73f85b09-90e3-486d-9d92-e0df2a011cc9",
 CellID->1999901332],
Cell[120309, 3131, 1846, 42, 126, "Input",ExpressionUUID->"de2cc48d-d4ae-476e-8c63-836a2ac140a2",
 CellID->939843114],
Cell[122158, 3175, 602, 13, 25, "ExampleText",ExpressionUUID->"39e3e07d-93a4-4a95-a5e5-598dd17ddf5e",
 CellID->433768664],
Cell[CellGroupData[{
Cell[122785, 3192, 3092, 71, 98, "Input",ExpressionUUID->"e5b1f425-2e64-40b8-92b8-acfb63c1c9d2",
 CellID->43101963],
Cell[125880, 3265, 1094, 24, 64, "Output",ExpressionUUID->"41512b13-c63e-4fb5-ac94-5b33e41242e2"]
}, Open  ]],
Cell[126989, 3292, 875, 19, 53, "ExampleText",ExpressionUUID->"aaacf810-198f-4891-b73a-7ecb53c19143",
 CellID->1069281746],
Cell[CellGroupData[{
Cell[127889, 3315, 2725, 60, 129, "Input",ExpressionUUID->"ef2c8774-48b4-4d6a-8e9e-00bf53bdb24e",
 CellID->1754108683],
Cell[130617, 3377, 1788, 44, 84, "Output",ExpressionUUID->"edf35adf-52b9-4542-b1cb-ce46713a7ec2"],
Cell[132408, 3423, 890, 12, 35, "Output",ExpressionUUID->"c5ab079e-fba4-4f19-8d34-9df2835b78b8"]
}, Open  ]],
Cell[133313, 3438, 646, 13, 25, "ExampleText",ExpressionUUID->"6764e151-ebba-4eea-be41-8f50ec3f5206",
 CellID->2125123813],
Cell[CellGroupData[{
Cell[133984, 3455, 2171, 37, 31, "Input",ExpressionUUID->"586e77a3-0f4a-4436-b412-f986331567b4",
 CellID->1874828429],
Cell[136158, 3494, 1158, 16, 35, "Output",ExpressionUUID->"a5d62979-a24e-4c7f-b374-785af5be95ef"]
}, Open  ]],
Cell[137331, 3513, 657, 13, 25, "ExampleText",ExpressionUUID->"8e592689-456f-4760-850d-2940218cc7fc",
 CellID->1370627916],
Cell[137991, 3528, 1995, 29, 31, "Input",ExpressionUUID->"013f4d2e-c987-492e-a1aa-fb8f53efdd35",
 CellID->607365897]
}, Open  ]],
Cell[CellGroupData[{
Cell[140023, 3562, 248, 7, 119, "Chapter",ExpressionUUID->"1aed5b35-83bb-49b3-88c8-c20b6996d8f6"],
Cell[140274, 3571, 1274, 19, 97, "ExampleText",ExpressionUUID->"982e411a-e0ac-49dd-a77f-79419687cf9b",
 CellID->913191182],
Cell[141551, 3592, 970, 15, 43, "ExampleText",ExpressionUUID->"c1369ea6-a9b2-406c-895c-a366225312ae"],
Cell[142524, 3609, 1728, 45, 147, "Input",ExpressionUUID->"ee0e8708-dc20-49ea-aaaa-11ef6f445f1e",
 CellID->671962100],
Cell[144255, 3656, 900, 13, 43, "ExampleText",ExpressionUUID->"9e2e1f91-9f4d-47c0-9204-cb397fe494a8",
 CellID->1968582900],
Cell[145158, 3671, 1529, 45, 106, "Input",ExpressionUUID->"0ec404cc-3cc8-466e-a930-723f43b51eb5",
 CellID->496046602],
Cell[146690, 3718, 965, 15, 43, "ExampleText",ExpressionUUID->"5df9288a-4ee8-49e4-aa5f-22730074bca5",
 CellID->690768034],
Cell[147658, 3735, 820, 20, 71, "Input",ExpressionUUID->"058d5118-0735-48a9-a38a-70206ee41b78",
 CellID->276958412],
Cell[148481, 3757, 1029, 15, 43, "ExampleText",ExpressionUUID->"57f99943-9a89-4148-bd4a-b4db67a67cc7",
 CellID->1448011921],
Cell[149513, 3774, 1198, 27, 59, "Input",ExpressionUUID->"bc076a32-b801-43c9-8521-d8401c27b669",
 CellID->200430814],
Cell[150714, 3803, 939, 15, 25, "ExampleText",ExpressionUUID->"4be940f6-b551-4a10-90bb-bad1dbc73d18",
 CellID->32490493],
Cell[151656, 3820, 1326, 32, 31, "Input",ExpressionUUID->"5deca3e2-4b35-435c-96ed-096d5d837e34",
 CellID->596704046],
Cell[152985, 3854, 2240, 31, 79, "ExampleText",ExpressionUUID->"92fa8d12-044f-49de-ab93-13b558076b34",
 CellID->1506478874],
Cell[155228, 3887, 2264, 58, 141, "Input",ExpressionUUID->"6f4c1b49-e763-452e-8de3-fd954adca23c"],
Cell[157495, 3947, 2049, 32, 63, "ExampleText",ExpressionUUID->"dad9304d-607e-4f2c-8bbb-1d2c23ee890c",
 CellID->1438994093],
Cell[CellGroupData[{
Cell[159569, 3983, 1545, 43, 104, "Input",ExpressionUUID->"40053eb8-ef27-474f-b3f4-3f370c6bdd8c"],
Cell[161117, 4028, 463, 9, 37, "Output",ExpressionUUID->"60291401-9f9c-4ad0-9c7e-1860749d533d"]
}, Open  ]],
Cell[161595, 4040, 2216, 31, 133, "ExampleText",ExpressionUUID->"ce5286ca-e9ad-421a-8c09-3129537ec374",
 CellID->859968897],
Cell[CellGroupData[{
Cell[163836, 4075, 804, 15, 31, "Input",ExpressionUUID->"52d63625-87ae-4d39-b58e-e606d446a433",
 CellID->1181245871],
Cell[164643, 4092, 3446, 96, 165, "Output",ExpressionUUID->"48ea6034-bd77-41bf-ada3-6edca9ecec3b"]
}, Open  ]],
Cell[168104, 4191, 1611, 23, 43, "ExampleText",ExpressionUUID->"deb8c15c-457c-4f62-98a3-86ae1c957e62",
 CellID->1200626914],
Cell[CellGroupData[{
Cell[169740, 4218, 1380, 31, 78, "Input",ExpressionUUID->"ca508920-471f-4228-a1ed-71a6d001a441",
 CellID->618153103],
Cell[171123, 4251, 441, 6, 35, "Output",ExpressionUUID->"c907044d-1f76-4504-bf74-01d0a5a4c089"],
Cell[171567, 4259, 441, 6, 35, "Output",ExpressionUUID->"0fb33b3b-1be7-479f-b2e5-bca021a7310e"]
}, Open  ]],
Cell[172023, 4268, 1952, 28, 61, "ExampleText",ExpressionUUID->"b3167981-3d3b-47cc-b221-84d6966e2e51",
 CellID->382087190],
Cell[CellGroupData[{
Cell[174000, 4300, 2339, 52, 147, "Input",ExpressionUUID->"e47a44f1-448b-49ce-8ded-0a6bffec635b",
 CellID->1984894718],
Cell[176342, 4354, 1016, 17, 35, "Output",ExpressionUUID->"d6c7be5a-9f32-4fc6-b727-335230efe905"],
Cell[177361, 4373, 5501, 164, 327, "Output",ExpressionUUID->"c95f1cb7-d0fc-44bc-8969-fde40e760893"]
}, Open  ]],
Cell[182877, 4540, 1948, 28, 25, "ExampleText",ExpressionUUID->"c40e4839-4c2a-4d2b-92d7-97a941228283",
 CellID->494369864],
Cell[CellGroupData[{
Cell[184850, 4572, 1820, 34, 55, "Input",ExpressionUUID->"2abf0fa9-19bb-4be0-859d-476fae35d3af",
 CellID->976938184],
Cell[186673, 4608, 6110, 167, 285, "Output",ExpressionUUID->"9b360bf3-e20c-42f5-a7c2-fe3f0daf10eb"]
}, Open  ]],
Cell[192798, 4778, 2282, 32, 61, "ExampleText",ExpressionUUID->"f31b6a5d-a260-4a8c-b9ec-b22ebbe4f3a8",
 CellID->470199887],
Cell[CellGroupData[{
Cell[195105, 4814, 1771, 30, 72, "Input",ExpressionUUID->"6719ee1e-8d5b-4de7-a869-1c825ccfe92c",
 CellID->186017677],
Cell[196879, 4846, 1342, 27, 64, "Output",ExpressionUUID->"c7ed7536-3058-4fa4-8daa-9f2320e81f4d"]
}, Open  ]],
Cell[198236, 4876, 2282, 32, 43, "ExampleText",ExpressionUUID->"d7be63cc-10ee-4d07-bafb-c2fabee0a495",
 CellID->1160909760],
Cell[CellGroupData[{
Cell[200543, 4912, 1688, 26, 31, "Input",ExpressionUUID->"e7cdae42-3768-4910-8d51-4e699a8cab65",
 CellID->1884373775],
Cell[202234, 4940, 856, 12, 35, "Output",ExpressionUUID->"34b9c8b6-2ddf-4930-a73e-3829d8438451"]
}, Open  ]],
Cell[203105, 4955, 675, 13, 25, "ExampleText",ExpressionUUID->"95fa6fe0-e3f9-453f-847a-07d64231b7ad",
 CellID->250862890],
Cell[203783, 4970, 2270, 34, 78, "Input",ExpressionUUID->"c5dcabdc-925c-4356-875a-30c7c780211a",
 CellID->642415863]
}, Open  ]]
}, Open  ]]
}
]
*)

